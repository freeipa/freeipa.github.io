
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>WebUI_build &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/V3/WebUI_build';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="https://raw.githubusercontent.com/freeipa/freeipa.github.io/main/src/_static/freeipa-logo-small.png" class="logo__image" alt="Logo image" />
</a>
<div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Documentation.html">Documentation</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Troubleshooting.html">Troubleshooting</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/page/V3/WebUI_build.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>WebUI_build</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">WebUI_build</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-modules-and-web-ui-build">AMD modules and Web UI build</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design">Design</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-dojo">Introducing Dojo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uglify-js">Uglify.js</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-freeipa">Building FreeIPA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-module-wrapping">AMD module wrapping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build">Build</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-directory-structure">New directory structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#development-profiles">Development profiles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#offline-version">Offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-server">Test server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-cases">Use Cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#users">Users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#developers">Developers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-freeipa-layer-build">Make new FreeIPA layer build</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-environment-to-debug-source-codes-of-freeipa-layer-using-offline-version">Set environment to debug source codes of FreeIPA layer using offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-environment-to-debug-built-freeipa-layer-using-offline-version">Set environment to debug built FreeIPA layer using offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-source-codes-of-freeipa-layer-on-test-server">Copy source codes of FreeIPA layer on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-built-freeipa-layer-on-test-server">Copy built FreeIPA layer on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-internal-py-strings-for-web-ui-on-test-server">Update internal.py (strings for Web UI) on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clone-dojo-repositories">Clone Dojo repositories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-dojo-lib-build">Make new Dojo lib build</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-builder-build">Make new Builder build</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-management">Feature Management</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#major-configuration-options-and-enablement">Major configuration options and enablement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replication">Replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-on-other-development-teams">Impact on other development teams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-to-web-ui-and-other-components">Impact to Web UI and other components</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rfe-author">RFE author</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="webui-build">
<h1>WebUI_build<a class="headerlink" href="#webui-build" title="Link to this heading">#</a></h1>
</section>
<section id="amd-modules-and-web-ui-build">
<h1>AMD modules and Web UI build<a class="headerlink" href="#amd-modules-and-web-ui-build" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>One of the most recommended optimization techniques for web pages are
reduction of the number of http request and a minimization of JavaScript
file size. Web UI uses a lot of JavaScript files. These files can be
concatenated into a single file and then optimized by JavaScript
compiler which strips comments, white-spaces and does other
optimizations.</p>
</section>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Link to this heading">#</a></h2>
<p>The main idea is transform FreeIPA JavaScript files into AMD modules and
build them with a builder into single file, then the file will be
further optimized by JavaScript compiler.</p>
</section>
<section id="introducing-dojo">
<h2>Introducing Dojo<a class="headerlink" href="#introducing-dojo" title="Link to this heading">#</a></h2>
<p>This feature has two topics which are closely related: AMD modules with
AMD loader, and a builder. A loader from a dojo/dojo library is used as
a loader and a build tool from dojo/util library as a builder. Including
source codes of both libraries in FreeIPA repository is not desired
because of their number and size. Therefore FreeIPA git repository
contains only their compiled versions. The builder and a Dojo library
are both built by the builder itself.</p>
<p>Following tools were developed to simplify maintenance of Dojo
Libraries:</p>
<ul class="simple">
<li><p>util/prepare-dojo.sh - can checkout dojo/dojo or dojo/util from
github repositories to a directory outside FreeIPA directory. Then it
can apply custom patches on a builder and make symbolic links
src/dojo and src/build which points to the check-outed repositories.</p></li>
<li><p>util/make-dojo.sh - creates custom build of dojo/dojo. Requires
util/prepare-dojo.sh to be run before. Then it calls compile.sh to
minimize the build.</p></li>
<li><p>util/make-builder.sh - creates custom build of dojo/util/build
(builder). Requires util/prepare-dojo.sh to be run before. Then it
calls compile.sh to minimize the build.</p></li>
<li><p>util/compile.sh - compiles a build made by a builder using a
uglify.js compiler. Usually no need to use it alone.</p></li>
</ul>
</section>
<section id="uglify-js">
<h2>Uglify.js<a class="headerlink" href="#uglify-js" title="Link to this heading">#</a></h2>
<p>Builder transforms AMD packages into single or more files and does basic
minimization like stripping of comments. For further minimization a
proper JavaScript compiler has to be used. Uglify.js was chosen because
of it’s capabilities and also because it can be run in rhino environment
and thus to avoid problems of not having a common compiler on targeted
platforms. For easier usage a wrapper scripted was developed:
<em>util/uglifyjs/uglify SOURCE TARGET</em>. It will be better to run under
node.js when all target platforms will support it.</p>
</section>
<section id="building-freeipa">
<h2>Building FreeIPA<a class="headerlink" href="#building-freeipa" title="Link to this heading">#</a></h2>
<p>Web UI JavaScript files can be divided into three sets: third party
libraries, FreeIPA code and Dojo library. Lets call them layers. FreeIPA
now uses 4 third party libs. 2 of them are already compiled and the rest
has small size. No bigger optimization techniques are required here.
Dojo is already prepared for optimization. The focus of optimization is
therefore on FreeIPA layer.</p>
</section>
<section id="amd-module-wrapping">
<h2>AMD module wrapping<a class="headerlink" href="#amd-module-wrapping" title="Link to this heading">#</a></h2>
<p>Dojo/util/build tool (builder) is used as a builder of both FreeIPA and
Dojo layer. The builder works best with AMD modules. Full modification
of FreeIPA layer into AMD modules would require splitting files by
component and redefining a lot of dependencies which is a huge tasks.
Different approach is taken to avoid this problem at the moment:
Existing files are only wrapped with AMD module definition. They should
be converted to proper modules - with single purpose and clean
dependencies, gradually in a future. Same applies on Web UI tests.</p>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Link to this heading">#</a></h2>
<p>A build of FreeIPA layer is done by calling <em>util/make-ui.sh</em>. This
script is run at make-all phase of an RPM build. Make-ui.sh is not
checking errors during the build because we don’t provide dojo/dojo
source codes and thus there are dependency errors. Dojo builder can’t be
configured to ignore certain dependency errors and also can’t be built
against already built library. The layer is built even though there are
dependency errors, it’s not a blocker but it will be nice to fix it in a
future (in dojo upstream or by custom patch).</p>
</section>
<section id="new-directory-structure">
<h2>New directory structure<a class="headerlink" href="#new-directory-structure" title="Link to this heading">#</a></h2>
<p>Web UI directory structure was change because the old one didn’t suffice
new needs which are:</p>
<ul class="simple">
<li><p>separate layers into own directories - for AMD</p></li>
<li><p>easy switch between source code version and built version during
testing</p></li>
</ul>
<p>Following directories in a ui directory were created:</p>
<ul class="simple">
<li><p>src - contains all source codes. Special pages (login, logout, reset
password) JS code was not moved yet. Not used in production.</p></li>
<li><p>js - a production directory. At production it should contain built
layers, at development symbolic links to related folders in src or
build directories.</p></li>
<li><p>release - working dir at build phase</p></li>
<li><p>build - contains output of make-ui.sh and make-dojo.sh scripts.</p></li>
</ul>
<p>All FreeIPA layer JS sources were move to src/freeipa folder. Libraries
(jquery, jquery ui, bbq, json2) were moved to src/libs.</p>
</section>
<section id="development-profiles">
<h2>Development profiles<a class="headerlink" href="#development-profiles" title="Link to this heading">#</a></h2>
<p>Several approaches of debugging of UI can be considered when developing
UI. Developer can either use a machine with installed FreeIPA or he can
start Web UI from a development directory. When the latter case is used,
the Web UI uses JSON files stored in test/data directory which simulates
JSON-RPC communication. Because there is no communication with server,
we can call this approach an ‘offline version’.</p>
<section id="offline-version">
<h3>Offline version<a class="headerlink" href="#offline-version" title="Link to this heading">#</a></h3>
<p>Offline version uses FreeIPA layer source codes and built version of
dojo/dojo library by default. It can use built version of FreeIPA layer
or source codes of dojo/dojo library by changing of symbolic links in
<em>js</em> directory. To make this task easier, an ‘util/change-profile.sh’
script was developed. The script can also set `git update-index
–assume-unchanged` to prevent git from notifying about this change.</p>
</section>
<section id="test-server">
<h3>Test server<a class="headerlink" href="#test-server" title="Link to this heading">#</a></h3>
<p>Different approach must be applied when using test server for debugging.
In this case source codes or built layers must be copied to
<em>/usr/share/ipa</em> directory on the test server. To make the task easier
<em>util/sync.sh</em> script was created. Developer can specify which parts of
the UI in which form he wants to copy. The tool contains directory
mappings so developer doesn’t have think about where source codes or
build versions are placed. Look to Use Cases chapter or tool’s help for
more information.</p>
</section>
</section>
<section id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Link to this heading">#</a></h2>
</section>
<section id="users">
<h2>Users<a class="headerlink" href="#users" title="Link to this heading">#</a></h2>
<p>None</p>
</section>
<section id="developers">
<h2>Developers<a class="headerlink" href="#developers" title="Link to this heading">#</a></h2>
<p>Note: all commands are run from install/ui directory of FreeIPA source
dir.</p>
<section id="make-new-freeipa-layer-build">
<h3>Make new FreeIPA layer build<a class="headerlink" href="#make-new-freeipa-layer-build" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>only useful for debugging. It’s done automatically in make all phase
of RPM build.</p></li>
<li><p>run $ util/make-ui.sh</p></li>
</ul>
</section>
<section id="set-environment-to-debug-source-codes-of-freeipa-layer-using-offline-version">
<h3>Set environment to debug source codes of FreeIPA layer using offline version<a class="headerlink" href="#set-environment-to-debug-source-codes-of-freeipa-layer-using-offline-version" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>it’s the default profile after checkout</p></li>
<li><p>to switch back from other profile:</p>
<ul>
<li><p>$ util/change-profile.sh -p source</p></li>
</ul>
</li>
<li><p>open index.html by a browser using <a class="reference external" href="file://">file://</a> protocol:</p>
<ul>
<li><p><a class="reference external" href="file:///home/login/path-to-freeipa/freeipa/install/ui/index.html">file:///home/login/path-to-freeipa/freeipa/install/ui/index.html</a></p></li>
<li><p>when using Chrome, run it with –disable-web-security option
otherwise XHR won’t work</p></li>
</ul>
</li>
</ul>
</section>
<section id="set-environment-to-debug-built-freeipa-layer-using-offline-version">
<h3>Set environment to debug built FreeIPA layer using offline version<a class="headerlink" href="#set-environment-to-debug-built-freeipa-layer-using-offline-version" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>$ util/change-profile.sh -p compiled</p></li>
<li><p>open browser same way as in previous use case</p></li>
<li><p>note: this doesn’t create the compiled version, you have to run it
separately</p></li>
</ul>
</section>
<section id="copy-source-codes-of-freeipa-layer-on-test-server">
<h3>Copy source codes of FreeIPA layer on test server<a class="headerlink" href="#copy-source-codes-of-freeipa-layer-on-test-server" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>$ util/sync.sh –host <a class="reference external" href="mailto:root&#37;&#52;&#48;test&#46;example&#46;com">root<span>&#64;</span>test<span>&#46;</span>example<span>&#46;</span>com</a> –freeipa</p></li>
<li><p>you can replace root with any user who can write into /usr/share/ipa</p></li>
<li><p>add –clean option if you want to delete all files from target dir</p></li>
<li><p>run $ util/sync.sh –help to get more information about others
folders (images, root dir, libs) and option shortcuts</p></li>
</ul>
</section>
<section id="copy-built-freeipa-layer-on-test-server">
<h3>Copy built FreeIPA layer on test server<a class="headerlink" href="#copy-built-freeipa-layer-on-test-server" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>$ util/sync.sh –host <a class="reference external" href="mailto:root&#37;&#52;&#48;test&#46;example&#46;com">root<span>&#64;</span>test<span>&#46;</span>example<span>&#46;</span>com</a> –freeipa –compiled</p></li>
</ul>
</section>
<section id="update-internal-py-strings-for-web-ui-on-test-server">
<h3>Update internal.py (strings for Web UI) on test server<a class="headerlink" href="#update-internal-py-strings-for-web-ui-on-test-server" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>$ util/sync.sh –host <a class="reference external" href="mailto:root&#37;&#52;&#48;test&#46;example&#46;com">root<span>&#64;</span>test<span>&#46;</span>example<span>&#46;</span>com</a> –strings –restart</p></li>
<li><p>note: –restart restarts httpd on test server (systemctl restart
httpd.service). Required for changes to take effect.</p></li>
</ul>
</section>
<section id="clone-dojo-repositories">
<h3>Clone Dojo repositories<a class="headerlink" href="#clone-dojo-repositories" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>should be run only once</p></li>
<li><p>required only for Dojo and Builder build</p></li>
<li><p>$ util/prepare-dojo.sh –all</p>
<ul>
<li><p>creates dojo folder at the same dir as freeipa dir is. Can be
changed by –dir option, but it’s not well tested.</p></li>
<li><p>clones <a class="github reference external" href="https://github.com/dojo/dojo.git">dojo/dojo.git</a> and
<a class="github reference external" href="https://github.com/dojo/util.git">dojo/util.git</a> into dojo folder</p></li>
<li><p>checkouts both repos to tag 1.8.1 (should be change later when
updating dojo)</p></li>
<li><p>applies custom patches in util/build/patches dir on dojo/util repo</p></li>
<li><p>makes src/dojo and src/build symbolic links</p></li>
</ul>
</li>
<li><p>can be fine-tuned by running with different options, check –help</p></li>
</ul>
</section>
<section id="make-new-dojo-lib-build">
<h3>Make new Dojo lib build<a class="headerlink" href="#make-new-dojo-lib-build" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>required when FreeIPA layer has new dependency</p></li>
<li><p>requires to have dojo cloned</p></li>
<li><p>new dependencies should be define in src/dojo.profile.js in
layer.include list</p></li>
<li><p>run $ util/make-dojo.sh</p></li>
</ul>
</section>
<section id="make-new-builder-build">
<h3>Make new Builder build<a class="headerlink" href="#make-new-builder-build" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>required when a change in a builder is needed. Usually shouldn’t be.</p></li>
<li><p>requires to have dojo cloned</p></li>
<li><p>recommended workflow:</p>
<ul>
<li><p>clone dojo if not done: $ util/prepare-dojo.sh –all</p></li>
<li><p>checkout desired version, if needed $ util/prepare-dojo.sh –dojo
–util –checkout –branch VERSION</p></li>
<li><p>make required changes in dojo-root/util/build</p></li>
<li><p>run $ util/make-builder.sh</p></li>
<li><p>warning: builder is overwritten on successful build, use git reset
to change it back if needed</p></li>
<li><p>if all OK, create a patch file with the changes. Name should be:
XXX-dojo-build-NAME-YY-commit-message.patch, where XXX is a the
following number than in the last patch, NAME is your login, nick
and YY is your patch number starting from 00</p></li>
<li><p>store the patch into util/build/patches directory (will require a
force option on git add)</p></li>
<li><p>make patch of all these changes and send it for review</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">#</a></h2>
<p>Any additional requirements or changes discovered during the
implementation phase.</p>
</section>
<section id="feature-management">
<h2>Feature Management<a class="headerlink" href="#feature-management" title="Link to this heading">#</a></h2>
<p>From new user feature POV doesn’t affect Web UI or CLI.</p>
</section>
<section id="major-configuration-options-and-enablement">
<h2>Major configuration options and enablement<a class="headerlink" href="#major-configuration-options-and-enablement" title="Link to this heading">#</a></h2>
<p>No configuration options.</p>
</section>
<section id="replication">
<h2>Replication<a class="headerlink" href="#replication" title="Link to this heading">#</a></h2>
<p>No impact.</p>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h2>
<p>rhino 1.7R3 on build machine (minimum version with common JS modules
support)</p>
</section>
<section id="impact-on-other-development-teams">
<h2>Impact on other development teams<a class="headerlink" href="#impact-on-other-development-teams" title="Link to this heading">#</a></h2>
<p>No impact.</p>
</section>
<section id="impact-to-web-ui-and-other-components">
<h2>Impact to Web UI and other components<a class="headerlink" href="#impact-to-web-ui-and-other-components" title="Link to this heading">#</a></h2>
<p>Pure Web UI change. Speeds up Web UI load.</p>
</section>
<section id="rfe-author">
<h2>RFE author<a class="headerlink" href="#rfe-author" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="User:Pvoborni">Petr Vobornik</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">WebUI_build</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-modules-and-web-ui-build">AMD modules and Web UI build</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design">Design</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-dojo">Introducing Dojo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uglify-js">Uglify.js</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-freeipa">Building FreeIPA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-module-wrapping">AMD module wrapping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build">Build</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-directory-structure">New directory structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#development-profiles">Development profiles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#offline-version">Offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-server">Test server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-cases">Use Cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#users">Users</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#developers">Developers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-freeipa-layer-build">Make new FreeIPA layer build</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-environment-to-debug-source-codes-of-freeipa-layer-using-offline-version">Set environment to debug source codes of FreeIPA layer using offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-environment-to-debug-built-freeipa-layer-using-offline-version">Set environment to debug built FreeIPA layer using offline version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-source-codes-of-freeipa-layer-on-test-server">Copy source codes of FreeIPA layer on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-built-freeipa-layer-on-test-server">Copy built FreeIPA layer on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-internal-py-strings-for-web-ui-on-test-server">Update internal.py (strings for Web UI) on test server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clone-dojo-repositories">Clone Dojo repositories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-dojo-lib-build">Make new Dojo lib build</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-new-builder-build">Make new Builder build</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-management">Feature Management</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#major-configuration-options-and-enablement">Major configuration options and enablement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replication">Replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-on-other-development-teams">Impact on other development teams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-to-web-ui-and-other-components">Impact to Web UI and other components</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rfe-author">RFE author</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>