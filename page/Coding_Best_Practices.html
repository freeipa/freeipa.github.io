

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Coding_Best_Practices &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/Coding_Best_Practices';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="/_static/freeipa-logo-small.png" class="logo__image only-light" alt="Logo image" />
</a>
<div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/page/Coding_Best_Practices.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Coding_Best_Practices</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Coding_Best_Practices</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#current">Current</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decorator-based-plugin-registration">Decorator-based plugin registration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-long-translatable-strings">Split long translatable strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#do-not-use-star-imports">Do not use star imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-admintool-framework-for-installation-management-scripts">Use the admintool framework for installation/management scripts</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#finished">Finished</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ldapentry-dict-like-api">LDAPEntry dict-like API</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="coding-best-practices">
<h1>Coding_Best_Practices<a class="headerlink" href="#coding-best-practices" title="Permalink to this heading">#</a></h1>
<p>Long-term ongoing <a class="reference external" href="V4/Refactorings">refactoring</a> means that some
practices you see in FreeIPA’s existing code are considered obsolete.
They should not be used in new code, and old code should be updated when
they are encountered.</p>
<p>Here is a list of these, with examples of the old and new way of doing
things.</p>
</section>
<section id="current">
<h1>Current<a class="headerlink" href="#current" title="Permalink to this heading">#</a></h1>
<section id="decorator-based-plugin-registration">
<h2>Decorator-based plugin registration<a class="headerlink" href="#decorator-based-plugin-registration" title="Permalink to this heading">#</a></h2>
<p>To allow registering plugins to non-default API objects, plugin
registration changed from:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">from ipalib import api</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">...</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class myobj_mod(LDAPUpdate): ...</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">api.register(myobj_mod)</span></code></div>
</div>
<p>to:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">from ipalib.plugable import Registry</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">register = Registry()</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">...</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">&#64;register()</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class myobj_mod(LDAPUpdate): ...</span></code></div>
</div>
<p>Note that it’s necessary to name the decorator <code class="docutils literal notranslate"><span class="pre">register</span></code>.</p>
</section>
<section id="split-long-translatable-strings">
<h2>Split long translatable strings<a class="headerlink" href="#split-long-translatable-strings" title="Permalink to this heading">#</a></h2>
<p>Long translatable strings, such as plugin modules’ <code class="docutils literal notranslate"><span class="pre">__doc__</span></code>, should
be split up by paragraph, so that if something is changed/added, only
the affected part needs to be re-translated. Example:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">__doc__ = _(&quot;&quot;&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Foo Plugin</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;) + _(&quot;&quot;&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">This plugin allows management of enterprise foos and bars.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;) + _(&quot;&quot;&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Here is a second paragraph.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;&quot;)</span></code></div>
</div>
<p>Note that the strings should <em>only</em> be split when they are changed,
because after a split all parts have to be re-translated.</p>
</section>
<section id="do-not-use-star-imports">
<h2>Do not use star imports<a class="headerlink" href="#do-not-use-star-imports" title="Permalink to this heading">#</a></h2>
<p>Star imports make it more difficult to see where names come from, and
names newly added to the imported module can unintentionally shadow
variables elsewhere.</p>
<p>Instead of</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">from baseldap import *</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class tank_create(LDAPCreate):</span></code></div>
</div>
<p>use</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">from ipalib.plugins import baseldap</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class tank_create(baseldap.LDAPCreate):</span></code></div>
</div>
<p>or</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">from ipalib.plugins.baseldap import LDAPCreate</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class tank_create(LDAPCreate):</span></code></div>
</div>
<p>See <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2653">https://fedorahosted.org/freeipa/ticket/2653</a>, and PEP8</p>
</section>
<section id="use-the-admintool-framework-for-installation-management-scripts">
<h2>Use the admintool framework for installation/management scripts<a class="headerlink" href="#use-the-admintool-framework-for-installation-management-scripts" title="Permalink to this heading">#</a></h2>
<p>There is a framework that standardizes common tasks such as argument
parsing, logging, error handling, interactive prompting. Use it.</p>
<p>For a simple example, see the implementation of
<code class="docutils literal notranslate"><span class="pre">ipa-server-certinstall</span></code>.</p>
<p>Related design concerning the CLI changes: <a class="reference external" href="V3/Logging_and_output">V3/Logging and
output</a></p>
</section>
</section>
<section id="finished">
<h1>Finished<a class="headerlink" href="#finished" title="Permalink to this heading">#</a></h1>
<p>For these items, all code in IPA was updated and, if applicable, the old
way of doing things was disabled.</p>
<section id="ldapentry-dict-like-api">
<h2>LDAPEntry dict-like API<a class="headerlink" href="#ldapentry-dict-like-api" title="Permalink to this heading">#</a></h2>
<p>See
<a class="reference external" href="HowTo/Migrate_your_code_to_the_new_LDAP_API">HowTo/Migrate_your_code_to_the_new_LDAP_API</a></p>
<p>A LDAPEntry no longer unpacks to a tuple:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># Old code</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">dn, attrs = entry</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">values = attrs[attrname]</span></code></div>
</div>
<p>Instead, the entry is a dict-like object:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># New code</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">dn = entry.dn</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">values = entry[attrname]</span></code></div>
</div>
<p>To highlight errors, a LDAPEntry currently cannot be iterated.</p>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Coding_Best_Practices</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#current">Current</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decorator-based-plugin-registration">Decorator-based plugin registration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-long-translatable-strings">Split long translatable strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#do-not-use-star-imports">Do not use star imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-admintool-framework-for-installation-management-scripts">Use the admintool framework for installation/management scripts</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#finished">Finished</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ldapentry-dict-like-api">LDAPEntry dict-like API</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>