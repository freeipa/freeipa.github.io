
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Certificate_renewal &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/V3/Certificate_renewal';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="https://raw.githubusercontent.com/freeipa/freeipa.github.io/main/src/_static/freeipa-logo-small.png" class="logo__image" alt="Logo image" />
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Documentation.html">Documentation</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Troubleshooting.html">Troubleshooting</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/page/V3/Certificate_renewal.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Certificate_renewal</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Certificate_renewal</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-certificate-renewal">IPA Certificate Renewal</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dogtag-ca">Dogtag CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selfsign-ca">Selfsign CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#short-term-plan">Short term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warn">Warn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medium-term-plan">Medium term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renew">Renew</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#renewing-the-agent-cert">Renewing the agent cert</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#long-term-plan">Long term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renewing-the-ca-certificate">Renewing the CA certificate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subordinate-ca-renewal">Subordinate CA renewal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#special-cases">Special cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rekeying-the-ca">Rekeying the CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rekeying-a-server-cert">Rekeying a server cert</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tickets">Tickets</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa">IPA</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="certificate-renewal">
<h1>Certificate_renewal<a class="headerlink" href="#certificate-renewal" title="Link to this heading">#</a></h1>
</section>
<section id="ipa-certificate-renewal">
<h1>IPA Certificate Renewal<a class="headerlink" href="#ipa-certificate-renewal" title="Link to this heading">#</a></h1>
<p>{{ admon/important | | This is a design page for a specific feature.
As project evolves it will become outdated and will not be maintained.
It is already known that FreeIPA 3.1 does not exactly work this way. }}</p>
<p>Certificates are valid for a varying period of time, capped by the
validity time of the root CA itself. The server certificates that IPA
issues are automatically renewed by certmonger before they expire. There
is currently no mechanism to renew the CA itself or the certificates it
requires.</p>
<p>The following certificates are issued for our two CA types.</p>
<section id="dogtag-ca">
<h2>Dogtag CA<a class="headerlink" href="#dogtag-ca" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>the root certificate itself (8 years in initial implementation, 15+
years when <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/3315">#3315</a>
was implemented )</p>
<ul class="simple">
<li><p>subject name CN=Certificate Authority,O=$REALM</p></li>
<li><p>enrolled using caCACert profile</p></li>
<li><p>private key in /var/lib/$CAINSTANCE/alias as “caSigningCert
cert-$CAINSTANCE”</p></li>
<li><p>exported to /root/cacert.p12 for use on replicas</p></li>
<li><p>stored in CS.cfg as ca.signing.cert</p></li>
<li><p>nickname in CS.cfg as ca.signing.nickname</p></li>
<li><p>copies stored in</p>
<ul>
<li><p>/var/lib/$CAINSTANCE/alias as “caSigningCert cert-$CAINSTANCE”</p></li>
<li><p>/etc/httpd/alias as “$REALM IPA CA”</p></li>
<li><p>/etc/dirsrv/slapd-PKI-CA as “$REALM IPA CA”</p></li>
<li><p>/etc/dirsrv/slapd-$DSINSTANCE as “$REALM IPA CA”</p></li>
<li><p>/etc/ipa/ca.crt</p></li>
</ul>
</li>
</ul>
</li>
<li><p>the OCSP subsystem certificate (2 years)</p>
<ul class="simple">
<li><p>subject name CN=OCSP Subsystem,O=$REALM</p></li>
<li><p>enrolled using caOCSPCert profile</p></li>
<li><p>private key in /var/lib/$CAINSTANCE/alias as “ocspSigningCert
cert-$CAINSTANCE”</p></li>
<li><p>exported to /root/cacert.p12 for use on replicas</p></li>
<li><p>stored in CS.cfg as ca.ocsp_signing.cert</p></li>
<li><p>nickname in CS.cfg as ca.ocsp_signing.nickname</p></li>
</ul>
</li>
<li><p>the CA SSL services certificate (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caServerCert profile</p></li>
<li><p>private key in /var/lib/$CAINSTANCE/alias as “Server-Cert
cert-$CAINSTANCE”</p></li>
<li><p>stored in CS.cfg as ca.sslserver.cert</p></li>
<li><p>nickname in CS.cfg as ca.sslserver.nickname</p></li>
</ul>
</li>
<li><p>CA subsystem certificate (2 years)</p>
<ul class="simple">
<li><p>subject name CN=CA Subsystem,O=$REALM</p></li>
<li><p>enrolled using caServerCert profile</p></li>
<li><p>private key in /var/lib/$CAINSTANCE/alias as “subsystemCert
cert-$CAINSTANCE”</p></li>
<li><p>exported to /root/cacert.p12 for use on replicas</p></li>
<li><p>stored in CS.cfg as ca.subsystem.cert</p></li>
<li><p>nickname in CS.cfg as ca.subsystem.nickname</p></li>
<li><p>published to uid=CA-rapier.bos.redhat.com-9443,ou=people,o=ipaca</p></li>
</ul>
</li>
<li><p>CA audit log certificate (2 years)</p>
<ul class="simple">
<li><p>subject name CN=CA Audit,O=$REALM</p></li>
<li><p>enrolled using caSignedLogCert profile</p></li>
<li><p>private key in /var/lib/$CAINSTANCE/alias as “auditSigningCert
cert-$CAINSTANCE”</p></li>
<li><p>exported to /root/cacert.p12 for use on replicas</p></li>
<li><p>stored in CS.cfg as ca.audit_signing.cert</p></li>
<li><p>nickname in CS.cfg as ca.audit_signing.nickname</p></li>
</ul>
</li>
<li><p>IPA CA agent (2 years)</p>
<ul class="simple">
<li><p>subject name CN=ipa-ca-agent,O=$REALM</p></li>
<li><p>enrolled using caAdminCert profile</p></li>
<li><p>exported to /root/ca-agent.p12</p></li>
<li><p>published to uid=admin,ou=people,o=ipaca</p></li>
</ul>
</li>
<li><p>IPA RA agent (2 years)</p>
<ul class="simple">
<li><p>subject name CN=IPA RA,O=$REALM</p></li>
<li><p>enrolled using caServerCert profile</p></li>
<li><p>private key in /etc/httpd/alias as “ipaCert”</p></li>
<li><p>published to uid=ipara,ou=people,o=ipaca</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>revoked by IPA RA agent, superseded</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>revoked by IPA RA agent, superseded</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>revoked by IPA RA agent, superseded</p></li>
</ul>
</li>
<li><p>CA jar signing (4 years)</p>
<ul class="simple">
<li><p>subject name CN=Object Signing Cert,O=$REALM</p></li>
<li><p>enrolled using caJarSigningCert profile</p></li>
<li><p>private key in /etc/httpd/alias as “Signing-Cert”</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>used to sign browser auto-configuration jar</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>private key in /etc/dirsrv/slapd-$DSINSTANCE as “Server-Cert”</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>monitored by certmonger</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>private key in /etc/dirsrv/slapd-PKI-IPA as “Server-Cert”</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>monitored by certmonger</p></li>
</ul>
</li>
<li><p>IPA service (2 years)</p>
<ul class="simple">
<li><p>subject name CN=$fqdn,O=$REALM</p></li>
<li><p>enrolled using caIPAserviceCert profile</p></li>
<li><p>private key in /etc/httpd/alias as “Server-Cert”</p></li>
<li><p>issued by IPA RA agent</p></li>
<li><p>monitored by certmonger</p></li>
</ul>
</li>
</ol>
</section>
<section id="selfsign-ca">
<h2>Selfsign CA<a class="headerlink" href="#selfsign-ca" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>the root certificate itself (10 years)</p>
<ul class="simple">
<li><p>subject name CN=$REALM Certificate Authority</p></li>
<li><p>private key in /etc/httpd/alias as “$REALM IPA CA”</p></li>
<li><p>copies stored in</p>
<ul>
<li><p>/etc/dirsrv/slapd-$DSINSTANCE as “$REALM IPA CA”</p></li>
<li><p>/etc/ipa/ca.crt</p></li>
</ul>
</li>
</ul>
</li>
<li><p>CA jar signing (10 years)</p>
<ul class="simple">
<li><p>subject name CN=Object Signing Cert,O=$REALM</p></li>
<li><p>enrolled using caJarSigningCert profile</p></li>
<li><p>private key in /etc/httpd/alias as “Signing-Cert”</p></li>
<li><p>used to sign browser auto-configuration jar</p></li>
</ul>
</li>
</ol>
<p>This document is going to focus on renewing Dogtag CA certificates. The
solutions are broken into short, medium and long-term, moving from more
manual to more automated.</p>
</section>
<section id="short-term-plan">
<h2>Short term plan<a class="headerlink" href="#short-term-plan" title="Link to this heading">#</a></h2>
</section>
<section id="warn">
<h2>Warn<a class="headerlink" href="#warn" title="Link to this heading">#</a></h2>
<p>certmonger can track certificates and make a note into a file what
certificate(s) need to be renewed. IPA can read this file and display
the contents on any ipa CLI or UI command when the user is in the admins
group. This will put the renewal front and center to any administrator.</p>
<p>We will warn at a configurable interval, storing the warning value in
cn=ipaconfig.</p>
<p>Manual instructions will be provided to users to handle renewing the
certificates and installing the result in the appropriate locations(s).</p>
<p>Information on renewals can be found at:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Certificate_System/8.1/html/Admin_Guide/Renewing_Certificates.html">http://docs.redhat.com/docs/en-US/Red_Hat_Certificate_System/8.1/html/Admin_Guide/Renewing_Certificates.html</a></p></li>
<li><p><a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Certificate_System/8.1/html/Admin_Guide/renewing-certificates.html">http://docs.redhat.com/docs/en-US/Red_Hat_Certificate_System/8.1/html/Admin_Guide/renewing-certificates.html</a></p></li>
</ul>
</section>
<section id="medium-term-plan">
<h2>Medium term plan<a class="headerlink" href="#medium-term-plan" title="Link to this heading">#</a></h2>
</section>
<section id="renew">
<h2>Renew<a class="headerlink" href="#renew" title="Link to this heading">#</a></h2>
<p>certmonger will be trained to talk directly to the CA and can renew all
but the CA root certificate. This renewal will only happen on the master
doing the CRL generation.</p>
<p>All CA system certificates have specific but different requirements.
Renewal enrollments allow one to submit serial number of a certificate
to be renewed. The CA recovers original certificate request and profile
used to generate original system certificate based on certificate serial
number provided in a renewal request. Knowing the original profile
allows the CA to regenerate an identical system certificate.</p>
<p>There is currently no way to determine the profile or request ID
required for renewing these CA certificates. A mechanism will need to be
created (where is TBD, though likely in the CA) to reconcile this.
Whatever process we come up with will need to work with existing
installations that did not store this information.</p>
<p>The certmonger on other IPA servers can use the EE public interface post
renewal time to see if updated certificates are available. If they are
it will retrieve them and install them as appropriate.</p>
<p>The time for doing the renewal should be configurable in IPA. certmonger
already has this as a configuration. I’m not sure if we want to tweak
that file on the fly or have certmonger query IPA in cn=ipaconfig. The
renewal time should be &gt; than the warning time to give renewal a chance
to occur before we start warning users of expiration.</p>
<p>There is also the issue of what machine renews these shared
certificates. The convention will be the CRL master will do this.
certmonger will periodically check to see if new certificates exist. We
will not revoke old CA subsystem certificates when a new one is issued.
This differs from what we do with IPA host and service certificates that
we issue.</p>
<section id="renewing-the-agent-cert">
<h3>Renewing the agent cert<a class="headerlink" href="#renewing-the-agent-cert" title="Link to this heading">#</a></h3>
<p>Renewing the RA agent cert requires an additional step. The public key
is stored in the PKI-IPA LDAP database and will need to be updated when
the certificate is renewed. If it isn’t then the agent will fail to
authenticate.</p>
</section>
</section>
<section id="long-term-plan">
<h2>Long term plan<a class="headerlink" href="#long-term-plan" title="Link to this heading">#</a></h2>
</section>
<section id="renewing-the-ca-certificate">
<h2>Renewing the CA certificate<a class="headerlink" href="#renewing-the-ca-certificate" title="Link to this heading">#</a></h2>
<p>Renewing the CA is a special case because it will require refreshing all
clients and servers in IPA. The renewal process is expected always to be
a manual process.</p>
<p>Updating the CA in the shared NSS database in /etc/pki/nssdb may be
handled by SSSD.</p>
</section>
<section id="subordinate-ca-renewal">
<h2>Subordinate CA renewal<a class="headerlink" href="#subordinate-ca-renewal" title="Link to this heading">#</a></h2>
<p>If the CA is installed as a subordinate of another then by definition
this is going to be a manual renewal process. The same problems of
sharing the updated CA certificate apply.</p>
</section>
<section id="special-cases">
<h2>Special cases<a class="headerlink" href="#special-cases" title="Link to this heading">#</a></h2>
</section>
<section id="rekeying-the-ca">
<h2>Rekeying the CA<a class="headerlink" href="#rekeying-the-ca" title="Link to this heading">#</a></h2>
<p>Rekeying of the CA requires a new CA install. This may also be
necessary/desired as the CA ages and certificates are revoked, unused,
etc, as maintenance. We will need a way to install a new CA alongside
the old one and slowly migrate all users to the new one.</p>
</section>
<section id="rekeying-a-server-cert">
<h2>Rekeying a server cert<a class="headerlink" href="#rekeying-a-server-cert" title="Link to this heading">#</a></h2>
<p>If an IPA service wants new keys it can do this now using either
certmonger or can generate a CSR and use the ipa cert-request command.</p>
</section>
</section>
<section id="tickets">
<h1>Tickets<a class="headerlink" href="#tickets" title="Link to this heading">#</a></h1>
<section id="ipa">
<h2>IPA<a class="headerlink" href="#ipa" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://fedorahosted.org/freeipa/ticket/1985">1985 Email notify Admin prior to CA certificate
expiration</a></p></li>
<li><p><a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2803">2803 RFE: Auto-renew IPA subsystem
certificates</a></p></li>
</ul>
<p><a class="reference external" href="Category:NoLink">Category:NoLink</a>
<a class="reference external" href="Category:CheckUpdate">Category:CheckUpdate</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Certificate_renewal</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-certificate-renewal">IPA Certificate Renewal</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dogtag-ca">Dogtag CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selfsign-ca">Selfsign CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#short-term-plan">Short term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warn">Warn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medium-term-plan">Medium term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renew">Renew</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#renewing-the-agent-cert">Renewing the agent cert</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#long-term-plan">Long term plan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renewing-the-ca-certificate">Renewing the CA certificate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subordinate-ca-renewal">Subordinate CA renewal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#special-cases">Special cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rekeying-the-ca">Rekeying the CA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rekeying-a-server-cert">Rekeying a server cert</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tickets">Tickets</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa">IPA</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>