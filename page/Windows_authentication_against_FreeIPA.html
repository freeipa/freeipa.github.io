
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Windows_authentication_against_FreeIPA &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/Windows_authentication_against_FreeIPA';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="https://raw.githubusercontent.com/freeipa/freeipa.github.io/main/src/_static/freeipa-logo-small.png" class="logo__image" alt="Logo image" />
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Documentation.html">Documentation</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Troubleshooting.html">Troubleshooting</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/page/Windows_authentication_against_FreeIPA.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Windows_authentication_against_FreeIPA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Windows_authentication_against_FreeIPA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Windows authentication against FreeIPA</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freeipa-is-not-an-active-directory-server">FreeIPA is not an Active Directory server</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-freeipa">Configure FreeIPA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-windows-ksetup">Configure Windows (ksetup)</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="windows-authentication-against-freeipa">
<h1>Windows_authentication_against_FreeIPA<a class="headerlink" href="#windows-authentication-against-freeipa" title="Link to this heading">#</a></h1>
</section>
<section id="id1">
<h1>Windows authentication against FreeIPA<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>This article describes direct integration between FreeIPA and Windows
machine, i.e. <strong>without involving Active Directory</strong> server. This
article <strong>does not</strong> apply to configurations where <a class="reference external" href="Trust">trust between AD and
FreeIPA</a> was established. Note also that the described
configuration is not supported by FreeIPA development team and also is
not supported by Red Hat Enterprise Linux Identity Management product. A
work on making possible to login to Windows machines already enrolled
into a trusted Active Directory forest is ongoing and is not available
yet in any released FreeIPA version.</p>
<ol class="arabic simple">
<li><p>If you already have AD we recommend using this system with AD and
using trusts between AD and IPA.</p></li>
<li><p>If you do not have AD then use Samba 4 instead of it. As of Samba
4.3, Samba AD can establish cross-realm trusts. The feature is still
incomplete and lacks proper access controls but it can be configured
to trust FreeIPA.</p></li>
<li><p>If neither of the two options work for you you can configure Windows
system to work directly with IPA as described below. It is an option
of last resort because IPA does not provide the services windows
client expects and FreeIPA development team does not support this
mode. If this is good enough for you, fine by us.</p></li>
<li><p>Build a native Windows client (cred provider) for IPA using latest
Kerberos. This would be really useful if someone does that because we
don’t have capacity to not build this ourselves. With the native OTP
support in IPA it becomes a real business opportunity to provide a
native 2FA inside enterprise across multiple platforms. But please do
it open source way otherwise we would not recommend you ;-)</p></li>
</ol>
<section id="freeipa-is-not-an-active-directory-server">
<h2>FreeIPA is not an Active Directory server<a class="headerlink" href="#freeipa-is-not-an-active-directory-server" title="Link to this heading">#</a></h2>
<p>FreeIPA is not a re-implementation of Microsoft Active Directory.
FreeIPA is focused on Linux (and other standards compliant) systems.</p>
<p>For this reason FreeIPA without configured <a class="reference external" href="Trusts">AD trust</a> can
provide only
<a class="reference external" href="http://en.wikipedia.org/wiki/Authentication">authentication</a> service
for Windows hosts (via standard <a class="reference external" href="http://en.wikipedia.org/wiki/Kerberos_%28protocol%29">Kerberos
protocol</a>).
FreeIPA can’t provide account database for Windows hosts in the same way
as AD does. You have to create local Windows account and appropriate
account mapping for each user if you select direct Windows&lt;=&gt;FreeIPA
integration. (This limitation doesn’t apply if you use <a class="reference external" href="Trusts">AD
trust</a>.)</p>
<p><a class="reference external" href="http://pgina.org/">Project pGina</a> could help you to overcome some
limitations.</p>
</section>
<section id="configure-freeipa">
<h2>Configure FreeIPA<a class="headerlink" href="#configure-freeipa" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Create the host principal in the web interface
2. Create IPA users to correspond to Windows users
3. Reset the user&#39;s IPA password to a known password using the web interface or CLI,
   the user will be prompted to change at first log in.
4. On the IPA server run
 ipa-getkeytab -s [kdc DNS name]
               -p host/[machine-name]
               -e  arcfour-hmac
               -k krb5.keytab.[machine-name]
               -P
 At the prompt enter a random MACHINE_PASSWORD
 (you will enter this later on the windows machine too).
 Note:  you  can  change  the  -e  argument  to  include  also
 AESenctypesfromFreeIPA2.1.4andhigher. (FreeIPA ticket ``\ ```2038`` &lt;https://fedorahosted.org/freeipa/ticket/2038&gt;`__\ ``)

 Note:  Windows  machines  names  cannot  exceed  15  characters
  -- pointed out by Han Boetes on 2013-01-03 on freeipa-users mailing list
</pre></div>
</div>
</section>
<section id="configure-windows-ksetup">
<h2>Configure Windows (ksetup)<a class="headerlink" href="#configure-windows-ksetup" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">ksetup</span> <span class="o">/</span><span class="n">setdomain</span> <span class="p">[</span><span class="n">REALM</span> <span class="n">NAME</span><span class="p">]</span>
<span class="mf">2.</span> <span class="n">ksetup</span> <span class="o">/</span><span class="n">addkdc</span> <span class="p">[</span><span class="n">REALM</span> <span class="n">NAME</span><span class="p">]</span> <span class="p">[</span><span class="n">kdc</span> <span class="n">DNS</span> <span class="n">name</span><span class="p">]</span>
<span class="mf">3.</span> <span class="n">ksetup</span> <span class="o">/</span><span class="n">addkpasswd</span> <span class="p">[</span><span class="n">REALM</span> <span class="n">NAME</span><span class="p">]</span> <span class="p">[</span><span class="n">kdc</span> <span class="n">DNS</span> <span class="n">name</span><span class="p">]</span>
<span class="mf">4.</span> <span class="n">ksetup</span> <span class="o">/</span><span class="n">setcomputerpassword</span> <span class="p">[</span><span class="n">MACHINE_PASSWORD</span><span class="p">]</span> <span class="p">(</span><span class="n">the</span> <span class="n">one</span> <span class="n">used</span> <span class="n">above</span><span class="p">)</span>
<span class="mf">5.</span> <span class="n">ksetup</span> <span class="o">/</span><span class="n">mapuser</span> <span class="o">*</span> <span class="o">*</span>
<span class="mf">6.</span> <span class="n">Run</span> <span class="n">gpedit</span><span class="o">.</span><span class="n">msc</span><span class="p">,</span> <span class="nb">open</span> <span class="n">the</span> <span class="n">key</span> <span class="n">called</span><span class="p">:</span>
 <span class="s2">&quot;Network Security: Configure encryption types allowed for Kerberos”</span>
 <span class="n">under</span><span class="p">:</span>
   <span class="n">Computer</span> <span class="n">Configuration</span>
     <span class="n">Windows</span> <span class="n">Settings</span>
       <span class="n">Security</span> <span class="n">Settings</span>
         <span class="n">Local</span> <span class="n">Policies</span>
           <span class="n">Security</span> <span class="n">Options</span>
 <span class="ow">and</span> <span class="n">deselect</span> <span class="n">everything</span> <span class="k">except</span> <span class="n">RC4_HMAC_MD5</span>
<span class="mf">7.</span> <span class="o">***</span> <span class="n">REBOOT</span> <span class="o">***</span>
<span class="mf">8.</span> <span class="n">Add</span> <span class="n">local</span> <span class="n">user</span> <span class="n">accounts</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">users</span> <span class="n">that</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span><span class="o">.</span>
<span class="mf">9.</span> <span class="n">Log</span> <span class="ow">in</span> <span class="k">as</span> <span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="o">@</span><span class="p">[</span><span class="n">REALM</span><span class="p">]</span> <span class="k">with</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">password</span><span class="p">,</span> <span class="n">you</span> <span class="n">will</span> <span class="n">be</span> <span class="n">prompted</span>
<span class="n">to</span> <span class="n">change</span> <span class="n">the</span> <span class="n">password</span> <span class="n">then</span> <span class="n">logged</span> <span class="ow">in</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Note: Configuring encryption types is not needed from FreeIPA 2.1.4
and higher.</strong> (FreeIPA ticket
<a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2038">2038</a>)</p>
<hr class="docutils" />
<p>The FreeIPA team thanks ‘Jimmy’ for providing this information on the
<a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2011-November/msg00156.html">freeipa-users</a>
mailing list. See mailing list archives for the original text. Several
amendments were made.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Windows_authentication_against_FreeIPA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Windows authentication against FreeIPA</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freeipa-is-not-an-active-directory-server">FreeIPA is not an Active Directory server</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-freeipa">Configure FreeIPA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-windows-ksetup">Configure Windows (ksetup)</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>