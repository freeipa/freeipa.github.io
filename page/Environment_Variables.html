
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Environment_Variables &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/Environment_Variables';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="https://raw.githubusercontent.com/freeipa/freeipa.github.io/main/src/_static/freeipa-logo-small.png" class="logo__image" alt="Logo image" />
</a>
<div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Documentation.html">Documentation</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Troubleshooting.html">Troubleshooting</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/page/Environment_Variables.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Environment_Variables</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-variables">Common variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-authentication">Basic Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kerberos-authentication">Kerberos Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#x-509-authentication">X.509 Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ldap-authentication">LDAP authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-additional-variables">Proposed Additional Variables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="environment-variables">
<h1>Environment_Variables<a class="headerlink" href="#environment-variables" title="Link to this heading">#</a></h1>
<p>Authenticating via Apache will set a number of environment variables,
depending on the configuration and the authentication method. I’m
skipping digest authentication because that is not commonly used.</p>
<section id="common-variables">
<h2>Common variables<a class="headerlink" href="#common-variables" title="Link to this heading">#</a></h2>
<p>A number of useful variables are set by Apache itself, they include:</p>
<table class="table">
<tbody>
<tr class="row-odd"><td><p>DOCUMENT_ROOT</p></td>
<td><p>The directory the current file/script is
executing</p></td>
</tr>
<tr class="row-even"><td><p>HTTP_ACCEPT</p></td>
<td><p>Contents of Accept: header</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP_HOST</p></td>
<td><p>Contents of Host: header</p></td>
</tr>
<tr class="row-even"><td><p>HTTP_USER_AGENT</p></td>
<td><p>Contents of User-Agent: header</p></td>
</tr>
<tr class="row-odd"><td><p>QUERY_STRING</p></td>
<td><p>The query string, if any</p></td>
</tr>
<tr class="row-even"><td><p>REMOTE_ADDR</p></td>
<td><p>The IP address of the client</p></td>
</tr>
<tr class="row-odd"><td><p>REMOTE_PORT</p></td>
<td><p>The port of the client machine</p></td>
</tr>
<tr class="row-even"><td><p>REQUEST_METHOD</p></td>
<td><p>The HTTP request method</p></td>
</tr>
<tr class="row-odd"><td><p>REQUEST_SCHEME</p></td>
<td><p>The scheme of the reqeust (e.g. http)</p></td>
</tr>
<tr class="row-even"><td><p>REQUEST_URI</p></td>
<td><p>The requested URI</p></td>
</tr>
<tr class="row-odd"><td><p>SERVER_ADDR</p></td>
<td><p>The IP address of the server</p></td>
</tr>
<tr class="row-even"><td><p>SERVER_NAME</p></td>
<td><p>The hostname of the server or virtual host</p></td>
</tr>
<tr class="row-odd"><td><p>SERVER_PORT</p></td>
<td><p>The port on the server</p></td>
</tr>
<tr class="row-even"><td><p>SERVER_PROTOCOL</p></td>
<td><p>Name and version of the request protocol</p></td>
</tr>
<tr class="row-odd"><td><p>SERVER_SIGNATURE</p></td>
<td><p>Server version and virtual host name added to
server-generated pages</p></td>
</tr>
<tr class="row-even"><td><p>SERVER_SOFTWARE</p></td>
<td><p>Server identification string</p></td>
</tr>
<tr class="row-odd"><td><p>UNIQUE_ID</p></td>
<td><p>ID set to be unique across requests.
mod_unique_id</p></td>
</tr>
</tbody>
</table>
</section>
<section id="basic-authentication">
<h2>Basic Authentication<a class="headerlink" href="#basic-authentication" title="Link to this heading">#</a></h2>
<p>Basic authentication is managed by Apache.</p>
<ul class="simple">
<li><p>AUTH_TYPE=Basic</p></li>
<li><p>REMOTE_USER=username</p></li>
</ul>
<p>The configuration may look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AuthType</span> <span class="n">Basic</span>
<span class="n">AuthName</span> <span class="s2">&quot;Restricted Files&quot;</span>
<span class="n">AuthBasicProvider</span> <span class="n">file</span>
<span class="n">AuthUserFile</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">passwords</span>
<span class="n">Require</span> <span class="n">valid</span><span class="o">-</span><span class="n">user</span>
</pre></div>
</div>
<p>The user database would be created with this:</p>
<p><code class="docutils literal notranslate"><span class="pre">htpasswd</span> <span class="pre">-c</span> <span class="pre">/etc/httpd/conf/passwords</span> <span class="pre">testuser</span></code></p>
</section>
<section id="kerberos-authentication">
<h2>Kerberos Authentication<a class="headerlink" href="#kerberos-authentication" title="Link to this heading">#</a></h2>
<p>Kerberos authentication is managed by mod_auth_gssapi or mod_auth_kerb.</p>
<ul class="simple">
<li><p>AUTH_TYPE=Negotiate</p></li>
<li><p><a class="reference external" href="mailto:REMOTE_USER=admin&#37;&#52;&#48;EXAMPLE&#46;COM">REMOTE_USER=admin<span>&#64;</span>EXAMPLE<span>&#46;</span>COM</a></p></li>
</ul>
<p>If delegation is enabled in the client and the server configuration
includes KrbSaveCredentials on, then KRB5CCNAME will be set pointing to
the user’s keytab.</p>
<p>The configuration may look something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AuthType</span> <span class="n">GSSAPI</span>
<span class="n">AuthName</span> <span class="s2">&quot;Kerberos Login&quot;</span>
<span class="n">GssapiCredStore</span> <span class="n">keytab</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">http</span><span class="o">.</span><span class="n">keytab</span>
</pre></div>
</div>
<p>for mod_auth_gssapi or for mod_auth_kerb:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AuthType</span> <span class="n">Kerberos</span>
<span class="n">AuthName</span> <span class="s2">&quot;Kerberos Login&quot;</span>
<span class="n">KrbMethodNegotiate</span> <span class="n">on</span>
<span class="n">KrbMethodK5Passwd</span> <span class="n">off</span>
<span class="n">KrbServiceName</span> <span class="n">HTTP</span>
<span class="n">KrbAuthRealms</span> <span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
<span class="n">Krb5KeyTab</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">ipa</span><span class="o">.</span><span class="n">keytab</span>
<span class="n">KrbSaveCredentials</span> <span class="n">on</span>
</pre></div>
</div>
</section>
<section id="x-509-authentication">
<h2>X.509 Authentication<a class="headerlink" href="#x-509-authentication" title="Link to this heading">#</a></h2>
<p>X.509 authentication is managed by either mod_nss or mod_ssl (or
mod_gnutls about which I know very little).</p>
<p>No specific AUTH_TYPE is set, see
<a class="reference external" href="https://issues.apache.org/bugzilla/show_bug.cgi?id=45058">https://issues.apache.org/bugzilla/show_bug.cgi?id=45058</a></p>
<p>The value of REMOTE_USER is dependent upon the configuration. If
SSLUserName or NSSUserName is set then that component of the client
certificate DN is set. The exception is when FakeBasicAuth is set, in
which case the full DN is set.</p>
<p>By default only the standard CGI environment variables are included,
plus HTTPS.</p>
<p>A number of SSL-specific variables are set if ExportCertData is enabled
in SSLOptions or NSSOptions.</p>
<p>There may be some slight differences in the variables available in
mod_ssl and mod_nss. For example, SSL_TLS_SNI is not available in
mod_nss.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Directory</span> <span class="s2">&quot;/var/www/secure&quot;</span><span class="o">&gt;</span>
    <span class="n">NSSOptions</span> <span class="o">+</span><span class="n">StdEnvVars</span>
    <span class="n">NSSVerifyClient</span> <span class="n">Require</span>
</pre></div>
</div>
<p>The mod_ssl configuration is similar. Replace NSS with SSL.</p>
<p>The variables are named the same between mod_ssl and mod_nss though the
contents may differ slightly. The set of variables available in httpd
2.4 are.</p>
<table class="table">
<tbody>
<tr class="row-odd"><td><p>HTTPS</p></td>
<td><p>HTTPS is being used.</p></td>
</tr>
<tr class="row-even"><td><p>SSL_PROTOCOL</p></td>
<td><p>The SSL protocol version (SSLv2, SSLv3,
TLSv1, TLSv1.1, TLSv1.2)</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SESSION_ID</p></td>
<td><p>The hex-encoded SSL session id</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CIPHER</p></td>
<td><p>The cipher specification name</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CIPHER_EXPORT</p></td>
<td><p>true if cipher is an export cipher</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CIPHER_USEKEYSIZE</p></td>
<td><p>Number of cipher bits (actually used)</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CIPHER_ALGKEYSIZE</p></td>
<td><p>Number of cipher bits (possible)</p></td>
</tr>
<tr class="row-even"><td><p>SSL_COMPRESS_METHOD</p></td>
<td><p>SSL compression method negotiated</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_VERSION_INTERFACE</p></td>
<td><p>The mod_ssl program version</p></td>
</tr>
<tr class="row-even"><td><p>SSL_VERSION_LIBRARY</p></td>
<td><p>The OpenSSL program version</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_M_VERSION</p></td>
<td><p>The version of the client certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_M_SERIAL</p></td>
<td><p>The serial of the client certificate</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_S_DN</p></td>
<td><p>Subject DN in client’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_S_DN_x509</p></td>
<td><p>Component of client’s Subject DN</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_I_DN</p></td>
<td><p>Issuer DN of client’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_I_DN_x509</p></td>
<td><p>Component of client’s Issuer DN</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_V_START</p></td>
<td><p>Validity of client’s certificate (start
time)</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_V_END</p></td>
<td><p>Validity of client’s certificate (end
time)</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_V_REMAIN</p></td>
<td><p>Number of days until client’s certificate
expires</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_A_SIG</p></td>
<td><p>Algorithm used for the signature of
client’s certificate</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_A_KEY</p></td>
<td><p>Algorithm used for the public key of
client’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_CERT</p></td>
<td><p>PEM-encoded client certificate</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_CLIENT_CERT_CHAIN_n</p></td>
<td><p>PEM-encoded certificates in client
certificate chain</p></td>
</tr>
<tr class="row-even"><td><p>SSL_CLIENT_VERIFY</p></td>
<td><p>NONE, SUCCESS, GENEROUS or FAILED:reason</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_M_VERSION</p></td>
<td><p>The version of the server certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_SERVER_M_SERIAL</p></td>
<td><p>The serial of the server certificate</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_S_DN</p></td>
<td><p>Subject DN in server’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_SERVER_S_DN_x509</p></td>
<td><p>Component of server’s Subject DN</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_I_DN</p></td>
<td><p>Issuer DN of server’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_SERVER_I_DN_x509</p></td>
<td><p>Component of server’s Issuer DN</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_V_START</p></td>
<td><p>Validity of server’s certificate (start
time)</p></td>
</tr>
<tr class="row-even"><td><p>SSL_SERVER_V_END</p></td>
<td><p>Validity of server’s certificate (end
time)</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_A_SIG</p></td>
<td><p>Algorithm used for the signature of
server’s certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_SERVER_A_KEY</p></td>
<td><p>Algorithm used for the public key of
server’s certificate</p></td>
</tr>
<tr class="row-odd"><td><p>SSL_SERVER_CERT</p></td>
<td><p>PEM-encoded server certificate</p></td>
</tr>
<tr class="row-even"><td><p>SSL_TLS_SNI</p></td>
<td><p>Contents of the SNI TLS extension (if
supplied with ClientHello)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ldap-authentication">
<h2>LDAP authentication<a class="headerlink" href="#ldap-authentication" title="Link to this heading">#</a></h2>
<p>Apache provides the module mod_authnz_ldap to perform authentication and
authorization over LDAP.</p>
<p>A simple configuration looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>AuthType Basic
AuthName &quot;LDAP Protected&quot;
AuthBasicProvider ldap
AuthLDAPURL ``\ ```ldap://127.0.0.1/dc=example,dc=com?uid?one`` &lt;ldap://127.0.0.1/dc=example,dc=com?uid?one&gt;`__
Require valid-user
</pre></div>
</div>
<p>Authorization can be done by specifying the allowed users, groups,
attribute with in an entry or even a filter.</p>
<p>Attributes can be specified in the AuthLDAPURL value such that those
values are set as environment variables of the form “AUTHENTICATE_”, so
any arbitrary list of values may be provided.</p>
</section>
<section id="proposed-additional-variables">
<h2>Proposed Additional Variables<a class="headerlink" href="#proposed-additional-variables" title="Link to this heading">#</a></h2>
<p>When Apache module is used for authentication, the authentication result
is passed to the application typically in the form of environment
variable REMOTE_USER. Current web applications however want and need to
create the user record in their internal databases so that foreign keys
validate, and applications also want to do access control checks
(authorizations) – applications typically don’t rely on Apache modules
for authorization.</p>
<p>We are in need of a way for Apache modules to pass information about the
authenticated user beyond the login name (in REMOTE_USER) to the
application. That way the applications do not need to implement all
possible authentication mechanisms (Kerberos, SAML, LDAP, …) and can
depend on specialized mod_auth_* modules to do it, while being able to
know what user to populate and maintain in their internal user database.</p>
<p>We propose Apache modules that wish to pass information about users to
applications adopt the following environment variable names:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><table class="table">
<tbody>
</tbody>
</table>
</th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Variable name</p>
<p>+================+================+================+================+
REMO
TE_USER_GROUPS</p>
<p>+================+================+================+================+
REMOTE
_USER_GROUP_N,
REMOTE
_USER_GROUP_1,
REMOTE
_USER_GROUP_2,
…</p>
<p>+================+================+================+================+
REM
OTE_USER_GECOS</p>
<p>+================+================+================+================+
REMO
TE_USER_DOMAIN</p>
<p>+================+================+================+================+
REM
OTE_USER_EMAIL</p>
<p>+================+================+================+================+
REMOTE_US
ER_GROUPS_JSON</p>
<p>+================+================+================+================+
REMOTE_
USER_FIRSTNAME</p>
<p>+================+================+================+================+
REMOTE_U
SER_MIDDLENAME
+================+================+================+================+
REMOTE
_USER_LASTNAME</p>
<p>+================+================+================+================+
REMOTE
_USER_FULLNAME</p>
<p>+================+================+================+================+
REMOT
E_USER_ORGUNIT</p>
<p>+================+================+================+================+
REMOTE_US
ER_EXTERNAL_ID</p>
<p>+================+================+================+================+
EXTER
NAL_AUTH_ERROR</p>
<p>+================+================+================+================+</p>
</td>
<td><p>Semantics</p>
<p>c
olon-separated
list of group
names the user
is in</p>
<p>number of user
groups and
individual
group names</p>
<p>Equivalent of
the GECOS
value from the
password file,
could be full
name.</p>
<p>domain the
user was
authenticated
in (could be
the domain in
sssd, nss,
LDAP, etc.)</p>
<p>user’s email
address</p>
<p>list of groups
the user is
in, formatted
as JSON string</p>
<p>user’s first
name</p>
<p>user’s middle
name</p>
<p>user’s last
name</p>
<p>user’s full
name formatted
as one string
(similar to
and possibly
the same as
REMO
TE_USER_GECOS)</p>
<p>organizational
unit to which
the user
belongs</p>
<p>SID, GUID, or
other unique
identifier
from the
external
identity
provider; used
to reconcile
account after
login change</p>
<p>when external
authentication
fails (and
REMOTE_USER is
not set), this
variable can
contain error
describing the
reason</p>
</td>
<td><p>Possible
source</p>
<p>POSIX call
getgrouplist;
sssd dbus call
o
rg.freedesktop
.sssd.infopipe
.GetUserGroups</p>
<p>alternate way
to get the
list of
groups,
avoiding the
split needed
with
REMO
TE_USER_GROUPS</p>
<p>pw_gecos field
of result of
POSIX call
getpwname; IPA
attribute
gecos, sssd
dbus call
org.freedeskt
op.sssd.infopi
pe.GetUserAttr
gecos</p>
<p>IPA attribute
mail,
sssd-dbus
attribute mail</p>
<p>IPA attribute
givenname,
sssd-dbus
attribute
givenname</p>
<p>IPA attribute
sn, sssd-dbus
attribute sn</p>
<p>IPA attribute
cn or
displayname,
sssd-dbus
attribute cn
or displayname</p>
<p>IPA attribute
ou, sssd-dbus
attribute ou</p>
<p>IPA attribute
ipaUniqueId,
389 DS
attribute
nsUniqueID, AD
attribute
objectSid</p>
</td>
<td><p>Example
<a class="reference external" href="http://www.adelton.com/apache/mod_lookup_identity/">mod_l
ookup_identity</a>
configuration</p>
<p>Look
upOutputGroups
REMO
TE_USER_GROUPS
:</p>
<p>Lookup
UserGroupsIter
REM
OTE_USER_GROUP</p>
<p>L
ookupUserGECOS
REM
OTE_USER_GECOS
or
LookupUserAttr
gecos
REM
OTE_USER_GECOS</p>
<p>LookupUserAttr
mail
REM
OTE_USER_EMAIL</p>
<p>LookupUserAttr
givenname
REMOTE_
USER_FIRSTNAME</p>
<p>LookupUserAttr
sn
REMOTE
_USER_LASTNAME</p>
<p>LookupUserAttr
cn
REMOTE
_USER_FULLNAME
or
LookupUserAttr
displayname
REMOTE
_USER_FULLNAME</p>
<p>LookupUserAttr
ou
REMOT
E_USER_ORGUNIT</p>
<p>LookupUserAttr
ipaUniqueId
REMOTE_US
ER_EXTERNAL_ID</p>
</td>
</tr>
</tbody>
</table>
<p>The character set for values should be UTF-8.</p>
<p>The list above is not exhaustive, authentication and identity modules
can provide additional variables with other values and meanings and
applications are welcome to use them.</p>
<p>Module mod_lookup_identity
(<a class="reference external" href="http://www.adelton.com/apache/mod_lookup_identity/">documentation</a>,
<a class="reference external" href="http://fedorapeople.org/cgit/adelton/public_git/mod_lookup_identity.git/">git
repo</a>)
has been created as a proof of concept for this way of information
passing. The full functionality depends on the sssd-dbus package (not
yet released, in testing).</p>
<p>Module mod_intercept_form_submit
(<a class="reference external" href="http://www.adelton.com/apache/mod_intercept_form_submit/">documentation</a>,
<a class="reference external" href="http://fedorapeople.org/cgit/adelton/public_git/mod_intercept_form_submit.git/">git
repo</a>)
has been created as a proof of concept for PAM authentication based on
form submission and it supports the REMOTE_USER and EXTERNAL_AUTH_ERROR
outputs, plus mod_lookup_identity can work based on the
mod_intercept_form_submit authentication result (latest versions of both
modules required).</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-variables">Common variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-authentication">Basic Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kerberos-authentication">Kerberos Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#x-509-authentication">X.509 Authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ldap-authentication">LDAP authentication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-additional-variables">Proposed Additional Variables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>