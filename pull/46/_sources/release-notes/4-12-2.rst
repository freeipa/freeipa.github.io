
{{ReleaseDate|2024-08-21}}
The FreeIPA team would like to announce FreeIPA 4.12.2 release!

It can be downloaded from http://www.freeipa.org/page/Downloads. Builds for
Fedora distributions will be available from the official repository soon.

== Highlights in 4.12.2 ==

'''TODO RELEASE NOTES - put release notes (if any) to proper categories'''
* 5169: [RFE] Enforce OTP for a subset of scenarios
:: When IPA user has an OTP token authentication enabled, it is now possible to enforce LDAP authentication to fail without providing OTP token. This is already the case for Kerberos authentication since 2014; however, some administrators like to enforce it for LDAP-backed applications. The fact that OTP was used for authentication will be recorded in LDAP server logs as MFA note, according to the design described at https://www.port389.org/docs/389ds/design/mfa-operation-note-design.html 
--------
* 9542: Fix replica connection check for use with AD administrator
:: Privilege checks in IPA API now support ID overrides, allowing trusted Active Directory users to perform various operations like enrolling a replica.
--------
'''END TODO'''

=== Enhancements ===

=== Known Issues ===


=== Bug fixes ===
FreeIPA 4.12.2 is a stabilization release for the features delivered as a
part of 4.12 version series.

There are more than 30 bug-fixes since FreeIPA 4.12.1 release.
Details of the bug-fixes can be seen in the list of resolved tickets below.

== Upgrading ==
Upgrade instructions are available on [https://www.freeipa.org/page/Upgrade Upgrade] page.

== Feedback ==
Please provide comments, bugs and other feedback via the freeipa-users mailing
list (https://lists.fedoraproject.org/archives/list/freeipa-users@lists.fedorahosted.org/)
or #freeipa channel on libera.chat.


== Resolved tickets ==
* [https://pagure.io/freeipa/issue/5169 #5169] [RFE] Enforce OTP for a subset of scenarios
* [https://pagure.io/freeipa/issue/8080 #8080] ipa-server-install --uninstall leaves files
* [https://pagure.io/freeipa/issue/9367 #9367] Covscan issues: Resource Leak
* [https://pagure.io/freeipa/issue/9488 #9488] Nightly test failure in test_trust.py::TestTrust::test_server_option_with_unreachable_ad
* [https://pagure.io/freeipa/issue/9542 #9542] Fix replica connection check for use with AD administrator
* [https://pagure.io/freeipa/issue/9584 #9584] Race condition in ipa-backup
* [https://pagure.io/freeipa/issue/9594 #9594] topologysegment commands cannot be delegated
* [https://pagure.io/freeipa/issue/9603 #9603] ipa-server-install: token_password_file read in kra.install_check after calling hsm_validator in ca.install_check
* [https://pagure.io/freeipa/issue/9606 #9606] Nightly test failure (f40+) in test_cert.py::TestCAShowErrorHandling::test_ca_show_error_handling
* [https://pagure.io/freeipa/issue/9607 #9607] Nightly test failure (f40+) in test_commands.py::TestIPACommand::test_ssh_key_connection
* [https://pagure.io/freeipa/issue/9609 #9609] ipa-otptoken-import fails to import encrypted file
* [https://pagure.io/freeipa/issue/9610 #9610]  ipa-client rpm post script creates always ssh_config.orig even if nothing needs to be changed
* [https://pagure.io/freeipa/issue/9611 #9611] kdc.crt certificate not getting automatically renewed by certmonger in IPA Hidden replica
* [https://pagure.io/freeipa/issue/9613 #9613] After backup/restore of dnssec master, zones are not signed
* [https://pagure.io/freeipa/issue/9615 #9615] Nightly test failure (f40+) in test_sssd.py::TestNestedMembers::test_nested_group_members
* [https://pagure.io/freeipa/issue/9616 #9616] Nightly test failure in test_backup_and_restore_TestReplicaInstallAfterRestore
* [https://pagure.io/freeipa/issue/9617 #9617] The ipa-advise, ipa-backup, and ipa-restore manuals incorrectly show the --v option.
* [https://pagure.io/freeipa/issue/9618 #9618] Allow IPA SIDgen task to continue if it finds an entity that SID can't be assigned to
* [https://pagure.io/freeipa/issue/9619 #9619] ipa-migrate starttls does not work
* [https://pagure.io/freeipa/issue/9620 #9620] ipa-migrate remove -V option
* [https://pagure.io/freeipa/issue/9621 #9621] ipa-migrate should not update mapped attributes in managed entries
* [https://pagure.io/freeipa/issue/9624 #9624] A missing cccache prevents Kerberos SSO
* [https://pagure.io/freeipa/issue/9625 #9625] Executing the -d option results in an error.
* [https://pagure.io/freeipa/issue/9626 #9626] ipa-replica/server-install with softhsm needs to check permission/ownership of /var/lib/softhsm/tokens to avoid install failure.
* [https://pagure.io/freeipa/issue/9629 #9629] Syntax error uninstalling the selinux-luna subpackage
* [https://pagure.io/freeipa/issue/9632 #9632] Unconditionally add MS-PAC to global config
* [https://pagure.io/freeipa/issue/9633 #9633] Remove RC4 and 3DES default encryption types on update
* [https://pagure.io/freeipa/issue/9635 #9635] Ignore time skew during CA replica installation
* [https://pagure.io/freeipa/issue/9636 #9636] misleading warning for missing ipa-selinux-nfast package on luna hsm
* [https://pagure.io/freeipa/issue/9637 #9637] adtrustinstance only prints issues in check_inst() and does not log them
* [https://pagure.io/freeipa/issue/9641 #9641] support for python cryptography 43.0.0
* [https://pagure.io/freeipa/issue/9642 #9642] ipa-migrate - properly handle invalid certificates
* [https://pagure.io/freeipa/issue/9643 #9643] freeipa fails to build with nodejs22 on f39 and f40
* [https://pagure.io/freeipa/issue/9644 #9644] Fedora 40 pylint issues with PY2/PY3 compatibility
* [https://pagure.io/freeipa/issue/9648 #9648] Nightly test failures in test_hsm_TestHSMNegative
== Detailed changelog since 4.12.1 ==
=== Alexander Bokovoy (5) ===
* Get rid of unicode and long helpers in ipa-otptoken-import [https://pagure.io/freeipa/c/7b5f3d79712a84f88ced6e9055bc96c9980b0b20 commit] [https://pagure.io/freeipa/issue/9641 #9641]
* ipalib/constants.py: factor out TripleDES use [https://pagure.io/freeipa/c/fc029043401bb852d2bfe8e8eccb926f50627b3b commit] [https://pagure.io/freeipa/issue/9641 #9641]
* ipalib/x509.py: get rid of unicode helper [https://pagure.io/freeipa/c/7f9c890c049f1151d3225e154fcde9bfed8cebb3 commit] [https://pagure.io/freeipa/issue/9644 #9644]
* ipalib/x509.py: support Cryptography 43 [https://pagure.io/freeipa/c/531bd05de9b3764b90804fcdad3b0b49ceb06110 commit] [https://pagure.io/freeipa/issue/9641 #9641]
* ipa-pwd-extop: differentiate OTP requirements in LDAP binds [https://pagure.io/freeipa/c/051d61fdc301f2768ac78c45e93a5f9eeff8aa28 commit] [https://pagure.io/freeipa/issue/5169 #5169]

=== Anuja More (1) ===
* ipatests: Test replica installation using AD admin. [https://pagure.io/freeipa/c/8b703150a47bf509f37856bdc27cfa99e85e5e6b commit] [https://pagure.io/freeipa/issue/9542 #9542]

=== Antonio Torres (2) ===
* Bump minor version number [https://pagure.io/freeipa/c/5b3735b09df0bc44ebaa59c5d8d1f3893b8dc33f commit] 
* Back to git snapshots [https://pagure.io/freeipa/c/ea375937861375f9052c17fe1ded2cdd2caad288 commit] 

=== Florence Blanc-Renaud (20) ===
* trust-add: handle unavailable domain [https://pagure.io/freeipa/c/f37c2eb8782ec06e538d8964bf904f1b7e79c15e commit] [https://pagure.io/freeipa/issue/9488 #9488]
* HSM: fix the module name [https://pagure.io/freeipa/c/1fc63e2b5150548edb3e910aa270e49c8b35223b commit] [https://pagure.io/freeipa/issue/9636 #9636]
* ipatests: skip HSM test if pki < 11.5.9 [https://pagure.io/freeipa/c/84751a26a95ee7bda541122c921a9c7fe4eb13d7 commit] [https://pagure.io/freeipa/issue/9648 #9648]
* ipatests: increase the timeout for test_hsm.py::TestHSMInstall [https://pagure.io/freeipa/c/81401e6c010a05b52bcc10306400dee9075b0e91 commit] 
* Replica CA installation: ignore time skew during initial replication [https://pagure.io/freeipa/c/aadb8051d4a3172aac3790f47ff4d241a245bab4 commit] [https://pagure.io/freeipa/issue/9635 #9635]
* spec file: do not use nodejs-22 on f39 and f40 [https://pagure.io/freeipa/c/2ddca5d5d57a877fbd598d8bdc29d0fe032621e8 commit] [https://pagure.io/freeipa/issue/9643 #9643]
* ipatests: remove xfail for test_ipa_migrate_stage_mode [https://pagure.io/freeipa/c/6eb6a929308c2916df9aed2da9ee6ef9d98e2438 commit] [https://pagure.io/freeipa/issue/9621 #9621]
* ipatests: remove xfail for test_ipa_migrate_version_option [https://pagure.io/freeipa/c/de940802bb6631fbbc97afd11869d87cba18f47f commit] [https://pagure.io/freeipa/issue/9620 #9620]
* test_replica_install_after_restore: kinit after restore [https://pagure.io/freeipa/c/d635d701100c9d3bdc179bae1f0d715fce30b461 commit] [https://pagure.io/freeipa/issue/9613 #9613]
* Uninstall: stop sssd-kcm before removing KCM ccaches database [https://pagure.io/freeipa/c/6fe268af5bc6c5296f7a380917e3134f8fa46fda commit] [https://pagure.io/freeipa/issue/9616 #9616]
* ipa-ods-enforcer: stop must also stop the socket [https://pagure.io/freeipa/c/2f902efd0e47eb2461429ce658f89d2a11f0891e commit] [https://pagure.io/freeipa/issue/9613 #9613]
* ipatests: fix / permissions for test_nested_group_members [https://pagure.io/freeipa/c/48ff7da5cb7ca8c3a5c21ce57f7c51e3e19958c8 commit] [https://pagure.io/freeipa/issue/9615 #9615]
* ipatests: fix / permissions to allow ssh with private key [https://pagure.io/freeipa/c/60c127d197f79fa4ed612f7173e752d156885415 commit] [https://pagure.io/freeipa/issue/9607 #9607]
* ipatests: mark test_ca_show_error_handling as xfail [https://pagure.io/freeipa/c/4521fe5f9125c74b4ad6e4e51f8c66c009079281 commit] [https://pagure.io/freeipa/issue/9606 #9606]
* ipatests: configure gating and nightly tests on ipa-4-12 branch [https://pagure.io/freeipa/c/58154be74fa950b3356712e60687930abb6480f1 commit] 
* ipatests: add test for PKINIT renewal on hidden replica [https://pagure.io/freeipa/c/467ec04f93a29fd31ba037cef348c09547541fe7 commit] [https://pagure.io/freeipa/issue/9611 #9611]
* PKINIT certificate: fix renewal on hidden replica [https://pagure.io/freeipa/c/c8e3fdeb0015f9c52c64816d6cd39279c5d3ad5a commit] [https://pagure.io/freeipa/issue/9611 #9611]
* ipatests: add test for ticket 9610 [https://pagure.io/freeipa/c/4d51446bd3cd9ab222f9978f8f5def1f3a37fa0e commit] [https://pagure.io/freeipa/issue/9610 #9610]
* spec file: do not create /etc/ssh/ssh_config.orig if unchanged [https://pagure.io/freeipa/c/09e66dc936cf2d99bcc44d60d6851aafa9ede46a commit] [https://pagure.io/freeipa/issue/9610 #9610]
* ipa-otptoken-import: open the key file in binary mode [https://pagure.io/freeipa/c/9de053ef02db8cb63e14edc64ac22ec2d3d7bbc9 commit] [https://pagure.io/freeipa/issue/9609 #9609]

=== Julien Rische (4) ===
* Remove RC4 and 3DES default encryption types on update [https://pagure.io/freeipa/c/9f88188204e443dd5d1d22ebe65b947452558f66 commit] [https://pagure.io/freeipa/issue/9633 #9633]
* Unconditionally add MS-PAC to global config on update [https://pagure.io/freeipa/c/d1a485a435ea9dba7587d1998451a09d3aa4077b commit] [https://pagure.io/freeipa/issue/9632 #9632]
* kdb: apply combinatorial logic for ticket flags [https://pagure.io/freeipa/c/4a61184da640759e9cd8907eaf975a8bfe9a1263 commit] 
* kdb: fix vulnerability in GCD rules handling [https://pagure.io/freeipa/c/f77c0a573c613fe541a040b938ae00524724584c commit] 

=== TAKAHASHI Masatsuna (1) ===
* ipa-advise ipa-backup ipa-restore: Fix --v option of the manual. [https://pagure.io/freeipa/c/52ea4ad46e5579bd41939680d75bf02c76ab119d commit] [https://pagure.io/freeipa/issue/9617 #9617]

=== Shunsuke matsumoto (1) ===
* The -d option of the ipa-advise command was able to used. [https://pagure.io/freeipa/c/06c02f5f2c524928b23ae3deeb42c6c57d3e47aa commit] [https://pagure.io/freeipa/issue/9625 #9625]

=== Mark Reynolds (4) ===
* ipa-migrate - properly handle invalid certificates [https://pagure.io/freeipa/c/0e4fbc3b0d15fd219d831b0b49f5312894448206 commit] [https://pagure.io/freeipa/issue/9642 #9642]
* Issue 9621 - ipa-migrate - should not update mapped attributes in managed entries [https://pagure.io/freeipa/c/85a853ba93c1d23d5bad13a1ae2bee802dc90131 commit] [https://pagure.io/freeipa/issue/9621 #9621]
* ipa-migrate - starttls does not work [https://pagure.io/freeipa/c/eeade50933cb2251b43ee34c642bcae69a216655 commit] [https://pagure.io/freeipa/issue/9619 #9619]
* ipa-migrate - remove -V option [https://pagure.io/freeipa/c/efa57193630f244185b3f295ed0de17c6d08f75a commit] [https://pagure.io/freeipa/issue/9620 #9620]

=== Mohammad Rizwan (2) ===
* ipatests: Verify that SIDgen task continue even if it fails to assign sid [https://pagure.io/freeipa/c/ee96c129a6034d02245a41c58fa3398c12c9ee75 commit] [https://pagure.io/freeipa/issue/9618 #9618]
* ipatests: tests related to --token-password-file [https://pagure.io/freeipa/c/4ea1ad6acae910574a524403bc82c80d24b525d6 commit] [https://pagure.io/freeipa/issue/9603 #9603]

=== Rob Crittenden (14) ===
* Fix some resource leaks identified by a static analyzer [https://pagure.io/freeipa/c/21c6ccc982b54e13b8058f9af130ce64426bd4bb commit] [https://pagure.io/freeipa/issue/9367 #9367]
* Ignore TripleDES python-cryptography import warnings [https://pagure.io/freeipa/c/d0684a7ecf474fcaf468816f4d9892ea5f2dc897 commit] [https://pagure.io/freeipa/issue/9641 #9641]
* Correct usage of public_key_algorithm_oid in ipalib/x509 [https://pagure.io/freeipa/c/5cc7941f30f14964abe14f7907e480e91a612ba2 commit] [https://pagure.io/freeipa/issue/9641 #9641]
* Log errors reported by adtrustinstance.check_inst() using logger [https://pagure.io/freeipa/c/e83d949c7f1734dff70379e360e9bbf626149c61 commit] [https://pagure.io/freeipa/issue/9637 #9637]
* Force a logout in KerberosSession if a login is needed [https://pagure.io/freeipa/c/ffba69648aa6b20cdc3d8950a982b49fd8004aa2 commit] [https://pagure.io/freeipa/issue/9624 #9624]
* Run HSM validation as pkiuser to verify token permissions [https://pagure.io/freeipa/c/38b83c2b9329b8b16096d63e83f186c91d578ce8 commit] [https://pagure.io/freeipa/issue/9626 #9626]
* ipatests: Fix usage of token_password_file [https://pagure.io/freeipa/c/f03a96a7b914eb5130552cea626fd28e26b2108d commit] [https://pagure.io/freeipa/issue/9603 #9603]
* Fix a copy/paste issue when detecting the HSM SELinux subpackage [https://pagure.io/freeipa/c/fdd471d55c73503456683b1dea55769700730b16 commit] [https://pagure.io/freeipa/issue/9636 #9636]
* Include token password options in ipa-kra-install man page [https://pagure.io/freeipa/c/6c53a22a2cacf7807df11e51492d1a2c42aeeda1 commit] [https://pagure.io/freeipa/issue/9603 #9603]
* Re-organize HSM validation to be more consistent/less duplication [https://pagure.io/freeipa/c/7ab1bcb2d364c26024db4ec99c707ebefffcd3e7 commit] [https://pagure.io/freeipa/issue/9603 #9603]
* Fix syntax error in the selinux-luna %postun script [https://pagure.io/freeipa/c/1b278de4ab9c5e00fb48dc2de1ea31d9bdfc94bc commit] [https://pagure.io/freeipa/issue/9629 #9629]
* Clean up more files and directories created by the installer(s) [https://pagure.io/freeipa/c/9e364910f537413cfce2b6ee2434579a5acf5c16 commit] [https://pagure.io/freeipa/issue/8080 #8080]
* Add iparepltopoconf objectclass to topology permissions [https://pagure.io/freeipa/c/ebccaac3cf8a5688739d76426924469d5b4df6b1 commit] [https://pagure.io/freeipa/issue/9594 #9594]
* Use a unique task name for each backend in ipa-backup [https://pagure.io/freeipa/c/584d0cecbcb99a09b09d5698fc906b4849a7234c commit] [https://pagure.io/freeipa/issue/9584 #9584]

=== Sudhir Menon (4) ===
* ipatests: Replace 'usermod -r' command with 'gpasswd -d' in test_hsm.py [https://pagure.io/freeipa/c/ed813fe6f0716906c8b9cd09c27e3acfb8b21e43 commit] [https://pagure.io/freeipa/issue/9626 #9626]
* ipatests: ipa-migrate tool with -Z option (CACERTFILE) [https://pagure.io/freeipa/c/8046023fc46c628c099d84b026ab866f7c6e16d6 commit] 
* Added new testsuite(ipa_ipa_migration) in prci definitions [https://pagure.io/freeipa/c/ab47696fa69499bedc393f61909fd5675815123e commit] 
* ipatests: Tests for ipa-ipa migration tool [https://pagure.io/freeipa/c/90b22ff888cc55132c78024d08ffcf0ce8021cea commit] 

=== Thomas Woerner (1) ===
* ipa_sidgen: Allow sidgen_task to continue after finding issues [https://pagure.io/freeipa/c/a8e75bbb77e15e3a42adb2d30933cf9e1edd2f0b commit] [https://pagure.io/freeipa/issue/9618 #9618]

