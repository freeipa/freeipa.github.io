
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Delegation &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/Delegation';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="https://raw.githubusercontent.com/freeipa/freeipa.github.io/main/src/_static/freeipa-logo-small.png" class="logo__image" alt="Logo image" />
</a>
<div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Documentation.html">Documentation</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/page/Troubleshooting.html">Troubleshooting</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/page/Delegation.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Delegation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-problem">The problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#writes">Writes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reads">Reads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-rights">Other rights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anonymous-access">Anonymous Access</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-solution">The Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-groups-and-acis">Task Groups and ACIs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#role-groups">Role Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bottom-line">The bottom line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aci-details">ACI Details</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source">Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rights">Rights</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target">Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-user">Create a new user</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reset-password">Reset password</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-user">Remove user</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#side-effects">Side effects</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#roles">Roles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-cases">Use Cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-admins-for-separate-containers">Separate admins for separate containers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limit-self-service-changes-by-attribute">Limit self-service changes by attribute</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flexibility-in-attributes-that-may-be-delegated">Flexibility in attributes that may be delegated</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delegate-entry-user-group-whatever-creation">Delegate entry (user, group, whatever) creation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-ui-capabilities-needed">Additional UI Capabilities Needed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#delegate-anything">Delegate anything</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-aci-parser">New ACI Parser</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ui-requirements">UI Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aci">ACI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-groups">Task Groups</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-a-new-task">How to create a new Task</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Role Groups</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-possible-capabilities">Additional Possible Capabilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limit-bind-rules">Limit Bind Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-state-of-affairs">Current State of Affairs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#who-writes-the-acis-tasks-and-roles">Who writes the ACIs, tasks and roles?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-will-acis-be-created">How will ACIs be created?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-will-acis-be-modified">How will ACIs be modified?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagram">Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-using-the-aci-commands">Examples using the aci commands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-aci">Adding an ACI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permissions">permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bind-rule">bind rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debugging">Debugging</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="delegation">
<h1>Delegation<a class="headerlink" href="#delegation" title="Link to this heading">#</a></h1>
<section id="the-problem">
<h2>The problem<a class="headerlink" href="#the-problem" title="Link to this heading">#</a></h2>
<p>Fine-grained access to parts of the DIT</p>
<p>We need to be able to say WHO can do WHAT to WHOM</p>
</section>
<section id="writes">
<h2>Writes<a class="headerlink" href="#writes" title="Link to this heading">#</a></h2>
<p>The WHO can be:</p>
<ul class="simple">
<li><p>a user or users</p></li>
<li><p>a group or groups</p></li>
</ul>
<p>The WHAT can be:</p>
<ul class="simple">
<li><p>modify one or more attributes on an entry (ex.)</p>
<ul>
<li><p>reset a password</p></li>
<li><p>modify an address</p></li>
<li><p>add a user to a group</p></li>
</ul>
</li>
<li><p>add a new entry</p></li>
<li><p>remove an existing entry</p></li>
</ul>
<p>The WHOM can be:</p>
<ul class="simple">
<li><p>a user or all users</p></li>
<li><p>a group or groups</p></li>
<li><p>self</p></li>
</ul>
</section>
<section id="reads">
<h2>Reads<a class="headerlink" href="#reads" title="Link to this heading">#</a></h2>
<p>Any user can read any other user or group. This is simply the unix way.
Some attributes such as password will always be protected. This was
extended to services in IPA v1 and will continue in v2 so one can see
what services are available.</p>
<p>We will not by default grant read access to:</p>
<ul class="simple">
<li><p>Machines</p></li>
<li><p>Policy</p></li>
</ul>
</section>
<section id="other-rights">
<h2>Other rights<a class="headerlink" href="#other-rights" title="Link to this heading">#</a></h2>
<p>The interesting rights that FDS provides that IPA would use are: read,
write, add, delete, search, and selfwrite.</p>
</section>
<section id="anonymous-access">
<h2>Anonymous Access<a class="headerlink" href="#anonymous-access" title="Link to this heading">#</a></h2>
<p>Currently there is read access to the entire subtree (minus a few
important attributes like userPassword) for anonymous users. In order to
limit access to services, machines, etc. I propose that we modify the
anonymous read access to include just users and groups. Basically just
enough so that nss_ldap will still work with an anonymous bind.</p>
</section>
<section id="the-solution">
<h2>The Solution<a class="headerlink" href="#the-solution" title="Link to this heading">#</a></h2>
<p>From a high level we will:</p>
<ul class="simple">
<li><p>Create groups (task groups) that are allowed to perform tasks</p></li>
<li><p>Create an ACI that grants permission for a group to perform a
specific task</p></li>
<li><p>Create groups (role groups) that will be be members of task groups,
granting the role group the underlying permission</p></li>
<li><p>Assign users and groups to role groups</p></li>
</ul>
</section>
<section id="task-groups-and-acis">
<h2>Task Groups and ACIs<a class="headerlink" href="#task-groups-and-acis" title="Link to this heading">#</a></h2>
<p>For the purposes of this discussion one task == one ACI “group”. These
groups will be stored outside of cn=accounts so they don’t interfere
with standard groups. I propose cn=taskgroup, dc=SUFFIX. The structural
objectclass will be groupOfNames.</p>
<p>1 task == 1 ACI</p>
<p>There may be multiple ACIs for a given high level task but it will be
implemented by combining low level tasks.</p>
<p>Take adding a user as an example. When a user is added we also
automatically add that user to the default IPA group (ipausers). For the
“Add a user” task we will need 3 ACIs:</p>
<ul class="simple">
<li><p>one to allow creating users and one to allow adding a user to a group
(access to the member attribute).</p></li>
<li><p>one to allow writing the member attribute of a group</p></li>
<li><p>allow the a password reset</p></li>
</ul>
<p>A 3rd task group may be created, “Add an IPA User”, that is a member of
these 3 task groups, combining them into a logical task. This will help
limit the total number of ACIs in the system, particularly with
duplication, because a task may be a member of several groups.</p>
<p>The ACIs will be stored in cn=accounts, the same way as in v1.</p>
</section>
<section id="role-groups">
<h2>Role Groups<a class="headerlink" href="#role-groups" title="Link to this heading">#</a></h2>
<p>We will also have role groups. A role is a collection of tasks or other
roles. These will be things like helpdesk, user admin, group admin,
replica admin, etc. These will also be stored outside of the cn=accounts
tree. These groups are for data management only and not for system
management. Perhaps in cn=delegationgroup, dc=SUFFIX. The structural
objectclass will be groupOfNames.</p>
<p>A role here is not to be confused with RBAC or native FDS/RHDS roles. It
is simply a term I’m using to designate the permissions of an
administrative group.</p>
<p>Rights are assigned by adding tasks as a member to these role groups. So
a helpdesk user may be able to see users, groups, and systems but only
have write access on user passwords. We would have several ACIs/task
groups to handle this:</p>
<ul class="simple">
<li><p>reset password</p></li>
<li><p>view users</p></li>
<li><p>view groups</p></li>
<li><p>view systems</p></li>
</ul>
<p>An IPA install will include a default set of canned tasks, including
things like:</p>
<ul class="simple">
<li><p>Add/Delete user</p></li>
<li><p>Add/Remove user to group</p></li>
<li><p>View Machines</p></li>
<li><p>Change password</p></li>
<li><p>etc</p></li>
</ul>
<p>Each one of these is a discrete ACI granting the appropriate permission
to a unique group (like add_user group, add user_to_group, etc). The
task group name itself is unimportant, it just needs to be unique and
hopefully meaningful.</p>
<p>We will continue to have the admin user and the admins group. This is
the super-user and group of users that can do whatever they would like
in the IPA world.</p>
</section>
<section id="the-bottom-line">
<h2>The bottom line<a class="headerlink" href="#the-bottom-line" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>An ACI grants permissions to a task group. There is a single ACI for
each task group. One may group ACIs together by adding their task
groups the same group.</p></li>
<li><p>A role is the member of one or more task groups</p></li>
<li><p>A user/group/role is a member of one or more roles</p></li>
</ul>
</section>
<section id="aci-details">
<h2>ACI Details<a class="headerlink" href="#aci-details" title="Link to this heading">#</a></h2>
<p>An ACI is made up 3 major components that we’re interested in:</p>
<ul class="simple">
<li><p>source/bind rule (WHO is being granted access)</p></li>
<li><p>rights (read, write, etc) (WHAT is being granted)</p></li>
<li><p>target (WHO you are granting rights to)</p></li>
</ul>
<section id="source">
<h3>Source<a class="headerlink" href="#source" title="Link to this heading">#</a></h3>
<p>This will always be a Task group.</p>
</section>
<section id="rights">
<h3>Rights<a class="headerlink" href="#rights" title="Link to this heading">#</a></h3>
<p>Will be: read, write, add, delete, search, and/or selfwrite</p>
<p>All ACIs will GRANT access, not deny it.</p>
</section>
<section id="target">
<h3>Target<a class="headerlink" href="#target" title="Link to this heading">#</a></h3>
<p>The target may be a set of attributes, a portion of the subtree a filter
or a combination of these.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h3>
<p>Note that in these examples I’m not using the new location to store the
task groups. You can apply these to a v1 IPA server to see how it works.</p>
<section id="create-a-new-user">
<h4>Create a new user<a class="headerlink" href="#create-a-new-user" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///uid=</span></code> &lt;<a class="reference external" href="ldap:///uid=">ldap:///uid=</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">*,cn=users,cn=accounts,dc=example,dc=com&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;add_user&quot;;allow</span> <span class="pre">(add)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com">ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
<p>But this isn’t enough. We also add the new user to the default IPA
group. Here is an ACI which allows that, specifically limiting the write
operation to the default group. This would be difficult to keep in sync
in reality but illustrates how tight we can make things.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(targetattr=member)(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com">ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;add_user_to_default_group&quot;;allow</span> <span class="pre">(write)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com">ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
<p>And still this isn’t enough. We also try to set the password. Rather
than doing this by setting the userPassword attribute we do an LDAP
password change. So we need to grant permission to change passwords as
well (see Reset password).</p>
<p>So now we have 3 task groups to add a user. If we wanted we could create
a 4th task group which combines these as a shortcut. This shows that
good descriptions will be required so that people making delegations can
understand what each task does. So this combined task should be named
something like create_ipa_user.</p>
<p>The task entry for the add_user ACI will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">add_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">add</span> <span class="n">new</span> <span class="n">users</span>
<span class="n">member</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">tuser</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">accounts</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
<p>The task entry for create_ipa_user will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">create_ipa_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">create_ipa_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">create</span> <span class="n">IPA</span> <span class="n">users</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user_to_default_group</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">change_password</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
</section>
<section id="reset-password">
<h4>Reset password<a class="headerlink" href="#reset-password" title="Link to this heading">#</a></h4>
<p>Crafting some rules may require a fairly detailed knowledge of LDAP and
the IPA implementation, as demonstrated with this long list of
attributes that may be written when resetting a password.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(targetattr</span> <span class="pre">=</span> <span class="pre">&quot;userPassword</span> <span class="pre">||</span> <span class="pre">krbPrincipalKey</span> <span class="pre">||</span> <span class="pre">sambaLMPassword</span> <span class="pre">||</span> <span class="pre">sambaNTPassword</span> <span class="pre">||</span> <span class="pre">passwordHistory&quot;)(version</span> <span class="pre">3.0;</span> <span class="pre">acl</span> <span class="pre">&quot;change_password&quot;;</span> <span class="pre">allow</span> <span class="pre">(write)</span> <span class="pre">groupdn</span> <span class="pre">=</span> <span class="pre">&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com">ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
</section>
<section id="remove-user">
<h4>Remove user<a class="headerlink" href="#remove-user" title="Link to this heading">#</a></h4>
<p>Once the basic structure of the ACIs is found then granting specific
rights becomes easier and easier. This is the same ACI as add_user
simply with a different right. One would also need to be a member of the
“modify group membership” group so that the membership may be modified.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///uid=</span></code> &lt;<a class="reference external" href="ldap:///uid=">ldap:///uid=</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">*,cn=users,cn=accounts,dc=example,dc=com&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;delete_user&quot;;allow</span> <span class="pre">(delete)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com">ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
</section>
<section id="side-effects">
<h4>Side effects<a class="headerlink" href="#side-effects" title="Link to this heading">#</a></h4>
<p>We may need to add in specific ACIs that prevent the deletion of
specific users and groups. admin comes to mind.</p>
</section>
<section id="roles">
<h4>Roles<a class="headerlink" href="#roles" title="Link to this heading">#</a></h4>
<p>These ACIs will be rolled up into a set of Roles, a set of which will be
pre-defined when IPA is shipped. These roles can then be customized by
IPA administrators to fit the site needs.</p>
<p>Helpdesk</p>
<p>Helpdesk users can typically reset passwords.</p>
<p>So we start with a helpdesk role:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">helpdesk</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">rolegroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">helpdesk</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Helpdesk</span>
<span class="n">member</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">tuser</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">accounts</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
<p>And add that role to the task for changing passwords:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">change_password</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">create_ipa_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">change</span> <span class="n">passwords</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">helpdesk</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">rolegroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Link to this heading">#</a></h2>
<section id="separate-admins-for-separate-containers">
<h3>Separate admins for separate containers<a class="headerlink" href="#separate-admins-for-separate-containers" title="Link to this heading">#</a></h3>
<p>Currently all users are in cn=users,cn=accounts. If we allow users to be
created in another part of the tree (aka another user container) then we
can create per-container admins, granting full access to this container
to that admin.</p>
<p>Alternatively we can grant access based on the value of an attribute in
a record that isn’t part of the DN using <code class="docutils literal notranslate"><span class="pre">targetfilter</span></code> to set the
target based on the value of an attribute:</p>
<p><code class="docutils literal notranslate"><span class="pre">(targetfilter</span> <span class="pre">=</span> <span class="pre">&quot;(|(ou=accounting)(ou=engineering))&quot;)</span></code></p>
</section>
<section id="limit-self-service-changes-by-attribute">
<h3>Limit self-service changes by attribute<a class="headerlink" href="#limit-self-service-changes-by-attribute" title="Link to this heading">#</a></h3>
<p>Add ability to limit what attributes can be modified on the self-service
page</p>
</section>
<section id="flexibility-in-attributes-that-may-be-delegated">
<h3>Flexibility in attributes that may be delegated<a class="headerlink" href="#flexibility-in-attributes-that-may-be-delegated" title="Link to this heading">#</a></h3>
<p>The list of attributes that one can grant write access to needs to be
configurable</p>
</section>
<section id="delegate-entry-user-group-whatever-creation">
<h3>Delegate entry (user, group, whatever) creation<a class="headerlink" href="#delegate-entry-user-group-whatever-creation" title="Link to this heading">#</a></h3>
<p>In v1 we only delegate attribute writes, not add or delete permissions.
Some granularity can be obtained by granting access only to users
(cn=users), groups (cn=groups), etc. along with attributes.</p>
</section>
</section>
<section id="additional-ui-capabilities-needed">
<h2>Additional UI Capabilities Needed<a class="headerlink" href="#additional-ui-capabilities-needed" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Means to select entries by container (if supported)</p></li>
<li><p>Means to select one or more entries (could be users or groups or
both)</p></li>
<li><p>Means to manage list of attributes that may be delegated</p></li>
<li><p>Means to manage add/list/delete delegations</p></li>
</ul>
</section>
<section id="delegate-anything">
<h2>Delegate anything<a class="headerlink" href="#delegate-anything" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>add users/groups/systems/other</p></li>
<li><p>delete users/groups/systems/other</p></li>
<li><p>allow arbitrary attributes (potential for abuse, breakage?)</p></li>
<li><p>An admin is a special kind of delegation, need a way to recognize
this in the UI</p></li>
</ul>
</section>
<section id="new-aci-parser">
<h2>New ACI Parser<a class="headerlink" href="#new-aci-parser" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>a fuller ACI class that can handle more complex syntax</p>
<ul>
<li><p>Needs to understand LDAP target</p></li>
<li><p>Ability to set source to targetattr, targetfilter and/or target</p></li>
<li><p>Set rights as a list</p></li>
<li><p>Validate ACIs before they are written</p></li>
</ul>
</li>
</ul>
</section>
<section id="ui-requirements">
<h2>UI Requirements<a class="headerlink" href="#ui-requirements" title="Link to this heading">#</a></h2>
<p>It is difficult to select an individual ACI over LDAP. What we will do
instead is slurp in all of them and prove that to the UI to display.
This should be refreshed between operations to avoid concurrency issues.</p>
<p>Once an ACI is written to LDAP it is immediately in effect.</p>
<p>The following operations are needed:</p>
<ul class="simple">
<li><p>CRUD for managing Task groups</p></li>
<li><p>CRUD for managing ACIs</p></li>
<li><p>CRUD for managing Role groups</p></li>
</ul>
<section id="aci">
<h3>ACI<a class="headerlink" href="#aci" title="Link to this heading">#</a></h3>
<p>An ACI has 4 attributes:</p>
<ul class="simple">
<li><p>name - a description of the ACI</p></li>
<li><p>source/bind rule - who is being authorized. This will generally be a
task group*</p></li>
<li><p>rights - read, write, add, delete, search, and selfwrite (may be more
than one)</p></li>
<li><p>target - May specify whether = or != one or more of the following:</p>
<ul>
<li><p>target - an LDAP uri pointing at a specific entry or a subtree</p></li>
<li><p>targetattr - one or more attributes</p></li>
<li><p>targetfilter - an LDAP filter</p></li>
</ul>
</li>
</ul>
<p>There are a couple of special LDAP bind rules:</p>
<ul class="simple">
<li><p>userdn = “<a class="reference external" href="ldap:///self">ldap:///self</a>”</p></li>
<li><p>userdn = “<a class="reference external" href="ldap:///anyone">ldap:///anyone</a>”</p></li>
</ul>
<p>self is used when defining an ACI for self-service. These are things
that you can do in your own record.</p>
<p>anyone is any bind, including an anonymous one.</p>
</section>
<section id="task-groups">
<h3>Task Groups<a class="headerlink" href="#task-groups" title="Link to this heading">#</a></h3>
<p>A task group has 3 attributes:</p>
<ul class="simple">
<li><p>cn (the group name)</p></li>
<li><p>description</p></li>
<li><p>member</p></li>
</ul>
<p>A member is a role group(s)</p>
<p>The membership of task groups will be read only. This will be managed
from the Role Groups. Otherwise may seem a bit backwards. What we are
doing with Role groups is defining what tasks a role may execute. To do
that we add the Role to the task group.</p>
<section id="how-to-create-a-new-task">
<h4>How to create a new Task<a class="headerlink" href="#how-to-create-a-new-task" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Create a new task group for the task</p></li>
<li><p>Create an ACI and assign it to the task group you just created</p></li>
</ol>
</section>
</section>
<section id="id1">
<h3>Role Groups<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>A role group has 3 attributes:</p>
<ul class="simple">
<li><p>cn (the group name)</p></li>
<li><p>description</p></li>
<li><p>member</p></li>
</ul>
<p>A member can either be another role group, a group or a user.</p>
<p>The Add/Update operations need to provide the ability to manage
membership of the task group. This defines the users/groups/roles that
may do the tasks associated with the role.</p>
<p>It also needs to provide the ability to manage which tasks a role may
operate on. By adding a task to a role the role gets added as a group
member of the task.</p>
</section>
</section>
<section id="additional-possible-capabilities">
<h2>Additional Possible Capabilities<a class="headerlink" href="#additional-possible-capabilities" title="Link to this heading">#</a></h2>
<p>These would be for v3 or beyond.</p>
</section>
<section id="limit-bind-rules">
<h2>Limit Bind Rules<a class="headerlink" href="#limit-bind-rules" title="Link to this heading">#</a></h2>
<p>We can add on additional bind rules for making changes if desired by:</p>
<ul class="simple">
<li><p>IP</p></li>
<li><p>time of day</p></li>
<li><p>IP</p></li>
<li><p>hostname</p></li>
</ul>
</section>
<section id="current-state-of-affairs">
<h2>Current State of Affairs<a class="headerlink" href="#current-state-of-affairs" title="Link to this heading">#</a></h2>
<p>Currently all ACIs are put into cn=accounts,dc=example,dc=com and can
grant the ability to write a fixed set of attributes from one group of
users to another.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>aci: (targetattr=&quot;title&quot;)(targetfilter=&quot;(memberOf=cn=bar,cn=groups,cn=accounts
,dc=example,dc=com)&quot;)(version 3.0;acl &quot;foobar&quot;;allow (write) groupdn=&quot;``\ ```ldap://`` &lt;ldap://&gt;`__
/cn=foo,cn=groups,cn=accounts,dc=example,dc=com&quot;;)
</pre></div>
</div>
</section>
<section id="who-writes-the-acis-tasks-and-roles">
<h2>Who writes the ACIs, tasks and roles?<a class="headerlink" href="#who-writes-the-acis-tasks-and-roles" title="Link to this heading">#</a></h2>
<p>Plugin authors, who know best what access may be granted for their given
operations, will create a list of ACIs for the plugin. This will likely
revolve around the CRUD operations to grant create, read, update and
delete access. There are special cases too, such as granting write
access to specific attributes in the case of passwords.</p>
<p>A predefined set of Roles will be created as well. The initial list will
be:</p>
<ul class="simple">
<li><p>Helpdesk</p></li>
<li><p>User admin</p></li>
<li><p>Group admin</p></li>
<li><p>Replica admin</p></li>
<li><p>Host admin</p></li>
<li><p>Service admin</p></li>
<li><p>CA admin</p></li>
<li><p>Netgroup admin</p></li>
<li><p>automount admin</p></li>
<li><p>netgroups admin</p></li>
</ul>
</section>
<section id="how-will-acis-be-created">
<h2>How will ACIs be created?<a class="headerlink" href="#how-will-acis-be-created" title="Link to this heading">#</a></h2>
<p>There will be no web UI for creating new ACIs.</p>
</section>
<section id="how-will-acis-be-modified">
<h2>How will ACIs be modified?<a class="headerlink" href="#how-will-acis-be-modified" title="Link to this heading">#</a></h2>
<p>The only modifications to ACIs will be in the list of attributes that
they cover and will only be available from the CLI.</p>
<p>For example, the edit User ACI may need to be expanded to include more
attributes than we grant by default. This CLI capability will let an
admin select from a set of attributes those whihc may be written.</p>
</section>
<section id="diagram">
<h2>Diagram<a class="headerlink" href="#diagram" title="Link to this heading">#</a></h2>
<p>A picture for your viewing pleasure.</p>
<p>Remember:</p>
<ul class="simple">
<li><p>An ACI grants access to an operation to a single Task group</p></li>
<li><p>A Role is a member of one or more Task groups</p></li>
<li><p>A user, group or Role is a member of one or more Roles</p></li>
</ul>
<figure class="align-default" id="id4">
<img alt="Picture" src="../_images/Delegation.png" />
<figcaption>
<p><span class="caption-text">Picture</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="examples-using-the-aci-commands">
<h2>Examples using the aci commands<a class="headerlink" href="#examples-using-the-aci-commands" title="Link to this heading">#</a></h2>
<p>The ACI rules that are shipped with IPA were all created using the api
plugin commands. This command should be used with great caution as you
are granting access to objects within IPA.</p>
<p>There isn’t exactly a 1-1 relationship between ACI’s and tasks but for
the most part this is true and thinking of it this way generally
simplifies things.</p>
<p>For a thorough description of ACIs you should read <a class="reference external" href="http://www.redhat.com/docs/manuals/dir-server/ag/8.0/Managing_Access_Control-Creating_ACIs_Manually.html">Creating ACIs
Manually</a></p>
</section>
<section id="adding-an-aci">
<h2>Adding an ACI<a class="headerlink" href="#adding-an-aci" title="Link to this heading">#</a></h2>
<p>An ACI has 3 basic components and here are the aci-add options that
manage them:</p>
<section id="id2">
<h3>target<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The target of the ACI tells us which entries are controlled by the ACI.
In general the more specific you can be the better.</p>
<ul class="simple">
<li><p>attrs - controls the attributes you are granting access to</p></li>
<li><p>type - a method to apply controls across a broad set of objects.
Possible options are: user, group and host</p></li>
<li><p>memberof - matches members of a group. Enter the group name</p></li>
<li><p>filter - Takes any valid LDAP filter to target the ACI. For example,
(ou=engineering)</p></li>
<li><p>subtree - A subtree the ACI applies to. This is effectively what the
type option does.</p></li>
<li><p>targetgroup - target a specific group, similar to memberof.</p></li>
</ul>
</section>
<section id="permissions">
<h3>permissions<a class="headerlink" href="#permissions" title="Link to this heading">#</a></h3>
<p>The permissions option tells the ACI what access you are granting</p>
<ul class="simple">
<li><p>write - can update existing entries, limited to a list of attributes
if used with –attrs</p></li>
<li><p>read - used to grant read access to attributes that might not
otherwise be available (potentially dangerous as you could grant read
access to the password, for example).</p></li>
</ul>
</section>
<section id="bind-rule">
<h3>bind rule<a class="headerlink" href="#bind-rule" title="Link to this heading">#</a></h3>
<p>The bind rule tells who this ACI is granting access to.</p>
<ul class="simple">
<li><p>taskgroup - A taskgroup, this is the model. The taskgroup will be
added automatically if it does not exist (beware of typos)</p></li>
<li><p>group - Grant access to a group of users directly.</p></li>
</ul>
</section>
<section id="id3">
<h3>Examples<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Problem: I want HR to be able to update anyone’s address.</p>
<p>ACI:
<code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">aci-add</span> <span class="pre">--taskgroup=updateaddress</span> <span class="pre">--attrs=street,st,postalcode,telephonenumber</span> <span class="pre">--permissions=write</span> <span class="pre">--type=user</span> <span class="pre">&quot;Update</span> <span class="pre">Address&quot;</span></code></p>
<p>Let’s say you have an <code class="docutils literal notranslate"><span class="pre">HR&gt;</span></code> role group. You would add it as a member
of the taskgroup <code class="docutils literal notranslate"><span class="pre">updateaddress</span></code>. This will grant all members of the
HR role to modify addresses.</p>
<p>Problem: I want to delegate the management of hosts.</p>
<p>ACI:
<code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">aci-add</span> <span class="pre">--taskgroup=hostmgmt</span> <span class="pre">--permissions=write,add,delete</span> <span class="pre">--type=host</span> <span class="pre">--attr=description,localityname,nshostlocation,nshardwareplatform,nsosversion</span> <span class="pre">&quot;Host</span> <span class="pre">Management&quot;</span></code></p>
<p>This will grant someone the ability to add, remove and update hosts.</p>
</section>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The aci plugin uses raw LDAP attributes. You can see the actual
attribute names in the plugin source</p></li>
<li><p>The output from the plugin is raw Directory Server ACIs which can be
a little difficult to understand at first</p></li>
</ul>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">#</a></h2>
<p>If you’ve created an ACI and it isn’t working as expected, one option is
to enable ACI debugging in the Directory Server.</p>
<p><strong>Fair Warning:</strong> This will have a tremendous performance impact on your
server. Do not do this on an operational system if you can avoid it.</p>
<p>You need to set nsslapd-errorlog-level to 128 in cn=config, like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">ldapmodify</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">D</span> <span class="s2">&quot;cn=Directory Manager&quot;</span> <span class="o">-</span><span class="n">W</span>
<span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">config</span>
<span class="n">changetype</span><span class="p">:</span> <span class="n">modify</span>
<span class="n">replace</span><span class="p">:</span> <span class="n">nsslapd</span><span class="o">-</span><span class="n">errorlog</span><span class="o">-</span><span class="n">level</span>
<span class="n">nsslapd</span><span class="o">-</span><span class="n">errorlog</span><span class="o">-</span><span class="n">level</span><span class="p">:</span> <span class="mi">128</span>
</pre></div>
</div>
<p>Set it back to 0 to disable debugging. Your DS errors log file will fill
up with ACI evaluations. The last entry should give you a pointer to
where the denial is originating.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-problem">The problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#writes">Writes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reads">Reads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-rights">Other rights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anonymous-access">Anonymous Access</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-solution">The Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-groups-and-acis">Task Groups and ACIs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#role-groups">Role Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bottom-line">The bottom line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aci-details">ACI Details</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source">Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rights">Rights</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target">Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-user">Create a new user</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reset-password">Reset password</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-user">Remove user</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#side-effects">Side effects</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#roles">Roles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-cases">Use Cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-admins-for-separate-containers">Separate admins for separate containers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limit-self-service-changes-by-attribute">Limit self-service changes by attribute</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flexibility-in-attributes-that-may-be-delegated">Flexibility in attributes that may be delegated</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delegate-entry-user-group-whatever-creation">Delegate entry (user, group, whatever) creation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-ui-capabilities-needed">Additional UI Capabilities Needed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#delegate-anything">Delegate anything</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-aci-parser">New ACI Parser</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ui-requirements">UI Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aci">ACI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-groups">Task Groups</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-a-new-task">How to create a new Task</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Role Groups</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-possible-capabilities">Additional Possible Capabilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limit-bind-rules">Limit Bind Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-state-of-affairs">Current State of Affairs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#who-writes-the-acis-tasks-and-roles">Who writes the ACIs, tasks and roles?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-will-acis-be-created">How will ACIs be created?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-will-acis-be-modified">How will ACIs be modified?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagram">Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-using-the-aci-commands">Examples using the aci commands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-aci">Adding an ACI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permissions">permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bind-rule">bind rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debugging">Debugging</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>