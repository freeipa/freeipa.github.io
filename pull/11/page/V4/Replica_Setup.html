

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Replica_Setup &#8212; FreeIPA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'page/V4/Replica_Setup';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><a class="navbar-brand logo" href="/">
    <img src="/_static/freeipa-logo-small.png" class="logo__image only-light" alt="Logo image" />
</a>
<div class="sidebar-primary-item">
    <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
        <div class="bd-toc-item navbar-nav active">
            <ul class="nav bd-sidenav">
                <li class="toctree-l1"><a class="reference internal" href="/About.html">About</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Contribute.html">Contribute</a></li>
                <li class="toctree-l1"><a class="reference internal" href="/Downloads.html">Downloads</a></li>
            </ul>
        </div>
    </nav>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/page/V4/Replica_Setup.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Replica_Setup</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-server-configuration">IPA server configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-replica-configuration">IPA replica configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-replica-server-in-ipaservers-group">IPA replica server in ipaservers group</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-client-enrolled-and-promoted-to-replica-with-one-time-password-in-one-step">IPA client enrolled and promoted to replica with One Time Password in one step</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="replica-setup">
<h1>Replica_Setup<a class="headerlink" href="#replica-setup" title="Permalink to this heading">#</a></h1>
<p>This text should be straightforward guide to users who want to setup and
test FreeIPA replica feature.</p>
<ul class="simple">
<li><p>Please note that used host names (ipa-server.example.test,
replica1.example.test, replica2.example.test) are only for better
orientation and these names do not take effect on setup.</p></li>
</ul>
<section id="ipa-server-configuration">
<h2>IPA server configuration<a class="headerlink" href="#ipa-server-configuration" title="Permalink to this heading">#</a></h2>
<p>First of all we need to install FreeIPA server to one of our machines.
This should be easily done with command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">freeipa</span><span class="o">-</span><span class="n">server</span> <span class="n">freeipa</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">dns</span>
</pre></div>
</div>
<p>The <em>freeipa-server-dns</em> is recommended to install but you will <strong>not</strong>
be notified until the <code class="docutils literal notranslate"><span class="pre">ipa-server-install</span></code> command has been run and
you will try to configure integrated DNS. You can try to set up entire
FreeIPA server but before installation process it will most likely fail
with <em>missing freeipa-server-dns</em> message. We will predict this and
install freeipa-server-dns too.</p>
<hr class="docutils" />
<p>After this we can set up our server defaults using command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">install</span> <span class="o">--</span><span class="n">domain</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">test</span> <span class="o">--</span><span class="n">realm</span><span class="o">=</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
</pre></div>
</div>
<p>This installation will ask for some additional information including
server administrator and Directory Manager password which you can see
down below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Do you want to configure DNS forwarders? [yes]: yes
Following DNS servers are configured in /etc/resolv.conf: 10.10.160.1, 10.16.101.41, 10.11.5.19
Do you want to configure these servers as DNS forwarders? [yes]: yes
All DNS servers from /etc/resolv.conf were added. You can enter additional addresses now:
Enter an IP address for a DNS forwarder, or press Enter to skip:
Checking DNS forwarders, please wait ...
Do you want to search for missing reverse zones? [yes]: yes

The IPA Master Server will be configured with:
Hostname:       ipa-server.example.test
IP address(es): 10.16.4.23
Domain name:    example.test
Realm name:     EXAMPLE.TEST

BIND DNS server will be configured to serve IPA domain with:
Forwarders:    10.10.160.1, 10.16.101.41, 10.11.5.19
Reverse zone(s):  No reverse zone

Continue to configure the system with these values? [no]: yes

The following operations may take some minutes to complete.
...
</pre></div>
</div>
<p>At this point we can say that we have basic FreeIPA server installation
done.</p>
<hr class="docutils" />
<p>Now we could get credentials as server administrator to test and later
configure ipa-server</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kinit</span> <span class="n">admin</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="ipa-replica-configuration">
<h2>IPA replica configuration<a class="headerlink" href="#ipa-replica-configuration" title="Permalink to this heading">#</a></h2>
<p>There are three ways to get it done. First is to use <em>admin’s</em> account
and enroll host using it, but we do not want to and we should not use
this administrator’s account or password like this. Instead we can
create user with privileges to enrol host and promote it with one time
password to replica so only his password will be used in configuration
(or even installation scripts) and second one is to add another host
into special hostgroup <em>ipaservers</em> and promote client into replica
without any password needed. We will try both of them.</p>
</section>
<hr class="docutils" />
<section id="ipa-replica-server-in-ipaservers-group">
<h2>IPA replica server in ipaservers group<a class="headerlink" href="#ipa-replica-server-in-ipaservers-group" title="Permalink to this heading">#</a></h2>
<p>This is may be the easiest way to get it done. The “only” thing to be
done is to have already enrolled replica machine added into
<code class="docutils literal notranslate"><span class="pre">ipaservers</span></code> group on main IPA server. To get it done you have to
enroll machine to IPA server first (if you had one please skip this
step). <strong>On the replica1 machine run:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>Configure client side components and use admin’s password:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ipa-client-install --domain=example.test --realm=EXAMPLE.TEST --server=ipa-server.example.test
...
Proceed with fixed values and no DNS discovery? [no]: yes
Client hostname: replica1.example.test
Realm: EXAMPLE.TEST
DNS Domain: example.test
IPA Server: ipa-server.example.test
BaseDN: dc=example,dc=test

Continue to configure the system with these values? [no]: yes
Skipping synchronizing time with NTP server.
User authorized to enroll computers: admin
Password for admin@EXAMPLE.TEST:
Successfully retrieved CA cert
    Subject:     CN=Certificate Authority,O=EXAMPLE.TEST
    Issuer:      CN=Certificate Authority,O=EXAMPLE.TEST
    Valid From:  Tue Aug 23 10:24:58 2016 UTC
    Valid Until: Sat Aug 23 10:24:58 2036 UTC

Enrolled in IPA realm EXAMPLE.TEST
...
</pre></div>
</div>
<ul class="simple">
<li><p>Please note that if host is already IPA enrolled and have client side
components installed we can skip these steps</p></li>
</ul>
<hr class="docutils" />
<p><strong>On the ipa-server</strong> we should now add our replica1 host into
ipaservers group with command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">hostgroup</span><span class="o">-</span><span class="n">add</span><span class="o">-</span><span class="n">member</span> <span class="n">ipaservers</span> <span class="o">--</span><span class="n">hosts</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Host</span><span class="o">-</span><span class="n">group</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Description</span><span class="p">:</span> <span class="n">IPA</span> <span class="n">server</span> <span class="n">hosts</span>
  <span class="n">Member</span> <span class="n">hosts</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
<span class="o">-------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">members</span> <span class="n">added</span> <span class="mi">1</span>
<span class="o">-------------------------</span>
</pre></div>
</div>
<p>Obviously the result of command <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">hostgroup-find</span></code> should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">hostgroup</span><span class="o">-</span><span class="n">find</span>
<span class="o">-------------------</span>
<span class="mi">1</span> <span class="n">hostgroup</span> <span class="n">matched</span>
<span class="o">-------------------</span>
  <span class="n">Host</span><span class="o">-</span><span class="n">group</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Description</span><span class="p">:</span> <span class="n">IPA</span> <span class="n">server</span> <span class="n">hosts</span>
  <span class="n">Member</span> <span class="n">hosts</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
<span class="o">----------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">entries</span> <span class="n">returned</span> <span class="mi">1</span>
<span class="o">----------------------------</span>
</pre></div>
</div>
<p>and result of <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">host-find</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------</span>
<span class="mi">2</span> <span class="n">hosts</span> <span class="n">matched</span>
<span class="o">---------------</span>
  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Principal</span> <span class="n">name</span><span class="p">:</span> <span class="n">host</span><span class="o">/</span><span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">host</span><span class="o">-</span><span class="n">groups</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">fingerprint</span><span class="p">:</span> <span class="mi">4</span><span class="n">B</span><span class="p">:</span><span class="n">F4</span><span class="p">:</span><span class="n">EB</span><span class="p">:</span><span class="mi">0</span><span class="n">E</span><span class="p">:</span><span class="mi">6</span><span class="n">E</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="n">C6</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">4</span><span class="n">E</span><span class="p">:</span><span class="n">E3</span><span class="p">:</span><span class="mi">2</span><span class="n">C</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="mi">0</span><span class="n">B</span><span class="p">:</span><span class="mi">42</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="p">),</span> <span class="mi">2</span><span class="n">B</span><span class="p">:</span><span class="mi">82</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="mi">2</span><span class="n">B</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">72</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="n">CA</span><span class="p">:</span><span class="mi">7</span><span class="n">F</span><span class="p">:</span><span class="mi">93</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="n">A0</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="mi">8</span><span class="n">B</span><span class="p">:</span><span class="mi">1</span><span class="n">B</span><span class="p">:</span><span class="n">D1</span> <span class="p">(</span><span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="p">),</span> <span class="n">DB</span><span class="p">:</span><span class="mi">1</span><span class="n">B</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="n">E9</span><span class="p">:</span><span class="mi">2</span><span class="n">D</span><span class="p">:</span><span class="n">D9</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="n">B2</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="n">A3</span><span class="p">:</span><span class="n">DD</span><span class="p">:</span><span class="mi">8</span><span class="n">A</span><span class="p">:</span><span class="n">B3</span><span class="p">:</span><span class="n">A8</span><span class="p">:</span><span class="mi">5</span><span class="n">A</span>
                              <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="p">)</span>

  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Principal</span> <span class="n">name</span><span class="p">:</span> <span class="n">host</span><span class="o">/</span><span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">host</span><span class="o">-</span><span class="n">groups</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">fingerprint</span><span class="p">:</span> <span class="mi">17</span><span class="p">:</span><span class="n">B0</span><span class="p">:</span><span class="n">CF</span><span class="p">:</span><span class="mi">8</span><span class="n">E</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="n">E8</span><span class="p">:</span><span class="mi">5</span><span class="n">E</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="n">BE</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="n">DC</span><span class="p">:</span><span class="mi">4</span><span class="n">D</span><span class="p">:</span><span class="mi">9</span><span class="n">F</span><span class="p">:</span><span class="mi">7</span><span class="n">B</span><span class="p">:</span><span class="mi">63</span><span class="p">:</span><span class="n">BB</span> <span class="p">(</span><span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="p">),</span> <span class="n">FE</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="n">F8</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="n">DD</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="n">BD</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="n">BF</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">1</span><span class="n">A</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="p">),</span> <span class="mi">70</span><span class="p">:</span><span class="n">D8</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="mi">7</span><span class="n">A</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="n">AA</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span><span class="mi">61</span><span class="p">:</span><span class="n">D0</span><span class="p">:</span><span class="n">ED</span><span class="p">:</span><span class="mi">2</span><span class="n">A</span><span class="p">:</span><span class="n">DF</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span><span class="n">A0</span>
                              <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="p">)</span>
<span class="o">----------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">entries</span> <span class="n">returned</span> <span class="mi">2</span>
<span class="o">----------------------------</span>
</pre></div>
</div>
<hr class="docutils" />
<p>If host <strong>replica1</strong> is successfully enrolled and in host group
ipaservers then we just run command <code class="docutils literal notranslate"><span class="pre">ipa-replica-install</span></code> and there is
no need for admin’s password as you can see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ipa-replica-install
WARNING: conflicting time&amp;date synchronization service &#39;chronyd&#39; will
be disabled in favor of ntpd

ipa         : ERROR    Reverse DNS resolution of address 10.16.4.23 (ipa-server.example.test) failed. Clients may not function properly. Please check your DNS setup. (Note that this check queries IPA DNS directly and ignores /etc/hosts.)
Continue? [no]: yes
Run connection check to master
Connection check OK
Configuring NTP daemon (ntpd)
  [1/4]: stopping ntpd
  [2/4]: writing configuration
  [3/4]: configuring ntpd to start on boot
  [4/4]: starting ntpd
Done configuring NTP daemon (ntpd).
Configuring directory server (dirsrv). Estimated time: 1 minute
...
</pre></div>
</div>
<p>Now we have IPA replica and we have get it done only by adding this host
into <em>ipaservers</em> group. Hosts in this group automatically gets
credentials to become replica and when <code class="docutils literal notranslate"><span class="pre">ipa-replica-install</span></code> command
used, you do not need to use administrator password or other users
privileged to promote host into replica.</p>
<p>We can now <code class="docutils literal notranslate"><span class="pre">kinit</span></code> as admin on <strong>replica1</strong> and add new user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">ipa</span> <span class="n">user</span><span class="o">-</span><span class="n">add</span> <span class="n">csantana</span> <span class="o">--</span><span class="n">first</span><span class="o">=</span><span class="n">Carlos</span> <span class="o">--</span><span class="n">last</span><span class="o">=</span><span class="n">Santana</span>
<span class="o">---------------------</span>
<span class="n">Added</span> <span class="n">user</span> <span class="s2">&quot;csantana&quot;</span>
<span class="o">---------------------</span>
  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">csantana</span>
  <span class="n">First</span> <span class="n">name</span><span class="p">:</span> <span class="n">Carlos</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santana</span>
  <span class="n">Full</span> <span class="n">name</span><span class="p">:</span> <span class="n">Carlos</span> <span class="n">Santana</span>
  <span class="n">Display</span> <span class="n">name</span><span class="p">:</span> <span class="n">Carlos</span> <span class="n">Santana</span>
  <span class="n">Initials</span><span class="p">:</span> <span class="n">CS</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">csantana</span>
  <span class="n">GECOS</span><span class="p">:</span> <span class="n">Carlos</span> <span class="n">Santana</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
  <span class="n">Kerberos</span> <span class="n">principal</span><span class="p">:</span> <span class="n">csantana</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">csantana</span><span class="nd">@example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">groups</span><span class="p">:</span> <span class="n">ipausers</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">user-find</span></code> command should display same output <strong>on both
ipa-server and replica1 machine</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">user</span><span class="o">-</span><span class="n">find</span>
<span class="o">---------------</span>
<span class="mi">2</span> <span class="n">users</span> <span class="n">matched</span>
<span class="o">---------------</span>
  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">admin</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Administrator</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217200000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217200000</span>
  <span class="n">Account</span> <span class="n">disabled</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">True</span>

  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">csantana</span>
  <span class="n">First</span> <span class="n">name</span><span class="p">:</span> <span class="n">Carlos</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santana</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">csantana</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
  <span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">csantana</span><span class="nd">@example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">Account</span> <span class="n">disabled</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">False</span>
<span class="o">----------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">entries</span> <span class="n">returned</span> <span class="mi">2</span>
<span class="o">----------------------------</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="ipa-client-enrolled-and-promoted-to-replica-with-one-time-password-in-one-step">
<h2>IPA client enrolled and promoted to replica with One Time Password in one step<a class="headerlink" href="#ipa-client-enrolled-and-promoted-to-replica-with-one-time-password-in-one-step" title="Permalink to this heading">#</a></h2>
<p><strong>On the IPA server</strong> we should add new host and copy <em>OTP</em> (Random
password):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">host</span><span class="o">-</span><span class="n">add</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span> <span class="o">--</span><span class="n">random</span>
<span class="o">----------------------------------------------</span>
<span class="n">Added</span> <span class="n">host</span> <span class="s2">&quot;replica2.example.test&quot;</span>
<span class="o">----------------------------------------------</span>
  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Random</span> <span class="n">password</span><span class="p">:</span> <span class="n">huN</span><span class="nd">@Nk5k9vjg</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
</pre></div>
</div>
<p>Then we make him member of host group ipaservers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">hostgroup</span><span class="o">-</span><span class="n">add</span><span class="o">-</span><span class="n">member</span> <span class="n">ipaservers</span> <span class="o">--</span><span class="n">hosts</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Host</span><span class="o">-</span><span class="n">group</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Description</span><span class="p">:</span> <span class="n">IPA</span> <span class="n">server</span> <span class="n">hosts</span>
  <span class="n">Member</span> <span class="n">hosts</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
<span class="o">-------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">members</span> <span class="n">added</span> <span class="mi">1</span>
<span class="o">-------------------------</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Now we have to install freeipa-server <strong>on replica2</strong>.example.test :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">freeipa</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>To configure replica on replica2.example.test machine just run:</p>
<ul class="simple">
<li><p>make sure that OTP is closed in quotes, there may be some special
characters which might be interpreted by shell</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span><span class="o">-</span><span class="n">replica</span><span class="o">-</span><span class="n">install</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;huN@Nk5k9vjg&#39;</span> <span class="o">--</span><span class="n">server</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span> <span class="o">--</span><span class="n">domain</span> <span class="n">example</span><span class="o">.</span><span class="n">test</span> <span class="o">--</span><span class="n">realm</span> <span class="n">EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
</pre></div>
</div>
<hr class="docutils" />
<p>After successful configuration on all three machines the output of
command <code class="docutils literal notranslate"><span class="pre">ipa-host-find</span></code> should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">host</span><span class="o">-</span><span class="n">find</span>
<span class="o">---------------</span>
<span class="mi">3</span> <span class="n">hosts</span> <span class="n">matched</span>
<span class="o">---------------</span>
  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Principal</span> <span class="n">name</span><span class="p">:</span> <span class="n">host</span><span class="o">/</span><span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">host</span><span class="o">-</span><span class="n">groups</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">ipa</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">fingerprint</span><span class="p">:</span> <span class="mi">4</span><span class="n">B</span><span class="p">:</span><span class="n">F4</span><span class="p">:</span><span class="n">EB</span><span class="p">:</span><span class="mi">0</span><span class="n">E</span><span class="p">:</span><span class="mi">6</span><span class="n">E</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="n">C6</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">4</span><span class="n">E</span><span class="p">:</span><span class="n">E3</span><span class="p">:</span><span class="mi">2</span><span class="n">C</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="mi">0</span><span class="n">B</span><span class="p">:</span><span class="mi">42</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="p">),</span> <span class="mi">2</span><span class="n">B</span><span class="p">:</span><span class="mi">82</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="mi">2</span><span class="n">B</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">72</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="n">CA</span><span class="p">:</span><span class="mi">7</span><span class="n">F</span><span class="p">:</span><span class="mi">93</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="n">A0</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="mi">8</span><span class="n">B</span><span class="p">:</span><span class="mi">1</span><span class="n">B</span><span class="p">:</span><span class="n">D1</span> <span class="p">(</span><span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="p">),</span> <span class="n">DB</span><span class="p">:</span><span class="mi">1</span><span class="n">B</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="n">E9</span><span class="p">:</span><span class="mi">2</span><span class="n">D</span><span class="p">:</span><span class="n">D9</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="n">B2</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="n">A3</span><span class="p">:</span><span class="n">DD</span><span class="p">:</span><span class="mi">8</span><span class="n">A</span><span class="p">:</span><span class="n">B3</span><span class="p">:</span><span class="n">A8</span><span class="p">:</span><span class="mi">5</span><span class="n">A</span>
                              <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="p">)</span>

  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Principal</span> <span class="n">name</span><span class="p">:</span> <span class="n">host</span><span class="o">/</span><span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">host</span><span class="o">-</span><span class="n">groups</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">replica1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">fingerprint</span><span class="p">:</span> <span class="mi">17</span><span class="p">:</span><span class="n">B0</span><span class="p">:</span><span class="n">CF</span><span class="p">:</span><span class="mi">8</span><span class="n">E</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="n">E8</span><span class="p">:</span><span class="mi">5</span><span class="n">E</span><span class="p">:</span><span class="n">F0</span><span class="p">:</span><span class="n">BE</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="n">DC</span><span class="p">:</span><span class="mi">4</span><span class="n">D</span><span class="p">:</span><span class="mi">9</span><span class="n">F</span><span class="p">:</span><span class="mi">7</span><span class="n">B</span><span class="p">:</span><span class="mi">63</span><span class="p">:</span><span class="n">BB</span> <span class="p">(</span><span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="p">),</span> <span class="n">FE</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="n">F8</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="n">DD</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="n">BD</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="n">BF</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">1</span><span class="n">A</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="p">),</span> <span class="mi">70</span><span class="p">:</span><span class="n">D8</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="mi">7</span><span class="n">A</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="n">AA</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span><span class="mi">61</span><span class="p">:</span><span class="n">D0</span><span class="p">:</span><span class="n">ED</span><span class="p">:</span><span class="mi">2</span><span class="n">A</span><span class="p">:</span><span class="n">DF</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span><span class="n">A0</span>
                              <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="p">)</span>

  <span class="n">Host</span> <span class="n">name</span><span class="p">:</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">Principal</span> <span class="n">name</span><span class="p">:</span> <span class="n">host</span><span class="o">/</span><span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">host</span><span class="o">-</span><span class="n">groups</span><span class="p">:</span> <span class="n">ipaservers</span>
  <span class="n">Keytab</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Managed</span> <span class="n">by</span><span class="p">:</span> <span class="n">replica2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">fingerprint</span><span class="p">:</span> <span class="mi">11</span><span class="p">:</span><span class="n">E6</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="n">AB</span><span class="p">:</span><span class="mi">0</span><span class="n">D</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="n">A4</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="n">BE</span><span class="p">:</span><span class="n">CB</span><span class="p">:</span><span class="mi">0</span><span class="n">F</span><span class="p">:</span><span class="mi">68</span><span class="p">:</span><span class="n">B1</span><span class="p">:</span><span class="mi">4</span><span class="n">A</span><span class="p">:</span><span class="n">EB</span><span class="p">:</span><span class="n">B8</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="p">),</span> <span class="mi">82</span><span class="p">:</span><span class="mi">78</span><span class="p">:</span><span class="mi">5</span><span class="n">E</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="n">B7</span><span class="p">:</span><span class="mi">92</span><span class="p">:</span><span class="n">D1</span><span class="p">:</span><span class="n">F4</span><span class="p">:</span><span class="n">C1</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="n">D1</span><span class="p">:</span><span class="mi">8</span><span class="n">E</span><span class="p">:</span><span class="n">C0</span><span class="p">:</span><span class="mi">87</span><span class="p">:</span><span class="mi">84</span> <span class="p">(</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="p">),</span> <span class="mi">46</span><span class="p">:</span><span class="n">FA</span><span class="p">:</span><span class="mi">6</span><span class="n">A</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="n">BD</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">5</span><span class="n">B</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="n">A4</span><span class="p">:</span><span class="mi">1</span><span class="n">B</span><span class="p">:</span><span class="n">C2</span><span class="p">:</span><span class="mi">4</span><span class="n">A</span><span class="p">:</span><span class="n">C1</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">77</span> <span class="p">(</span><span class="n">ecdsa</span><span class="o">-</span>
                              <span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="p">)</span>
<span class="o">----------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">entries</span> <span class="n">returned</span> <span class="mi">3</span>
<span class="o">----------------------------</span>
</pre></div>
</div>
<p>We just add one other user for example again <strong>on</strong> new
<strong>replica2</strong>.example.test to test functionality</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">user</span><span class="o">-</span><span class="n">add</span> <span class="n">sclaus</span> <span class="o">--</span><span class="n">first</span><span class="o">=</span><span class="n">Santa</span> <span class="o">--</span><span class="n">last</span><span class="o">=</span><span class="n">Claus</span>
<span class="o">-------------------</span>
<span class="n">Added</span> <span class="n">user</span> <span class="s2">&quot;sclaus&quot;</span>
<span class="o">-------------------</span>
  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">sclaus</span>
  <span class="n">First</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santa</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Claus</span>
  <span class="n">Full</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santa</span> <span class="n">Claus</span>
  <span class="n">Display</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santa</span> <span class="n">Claus</span>
  <span class="n">Initials</span><span class="p">:</span> <span class="n">SC</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">sclaus</span>
  <span class="n">GECOS</span><span class="p">:</span> <span class="n">Santa</span> <span class="n">Claus</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
  <span class="n">Kerberos</span> <span class="n">principal</span><span class="p">:</span> <span class="n">sclaus</span><span class="nd">@EXAMPLE</span><span class="o">.</span><span class="n">TEST</span>
  <span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">sclaus</span><span class="nd">@example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217250000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217250000</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Member</span> <span class="n">of</span> <span class="n">groups</span><span class="p">:</span> <span class="n">ipausers</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>And all ipaservers should display same info:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipa</span> <span class="n">user</span><span class="o">-</span><span class="n">find</span>
<span class="o">---------------</span>
<span class="mi">3</span> <span class="n">users</span> <span class="n">matched</span>
<span class="o">---------------</span>
  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">admin</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Administrator</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217200000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217200000</span>
  <span class="n">Account</span> <span class="n">disabled</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">True</span>

  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">csantana</span>
  <span class="n">First</span> <span class="n">name</span><span class="p">:</span> <span class="n">Carlos</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santana</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">csantana</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
  <span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">csantana</span><span class="nd">@example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217300000</span>
  <span class="n">Account</span> <span class="n">disabled</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">False</span>

  <span class="n">User</span> <span class="n">login</span><span class="p">:</span> <span class="n">sclaus</span>
  <span class="n">First</span> <span class="n">name</span><span class="p">:</span> <span class="n">Santa</span>
  <span class="n">Last</span> <span class="n">name</span><span class="p">:</span> <span class="n">Claus</span>
  <span class="n">Home</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">sclaus</span>
  <span class="n">Login</span> <span class="n">shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
  <span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">sclaus</span><span class="nd">@example</span><span class="o">.</span><span class="n">test</span>
  <span class="n">UID</span><span class="p">:</span> <span class="mi">1217250000</span>
  <span class="n">GID</span><span class="p">:</span> <span class="mi">1217250000</span>
  <span class="n">Account</span> <span class="n">disabled</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Password</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">Kerberos</span> <span class="n">keys</span> <span class="n">available</span><span class="p">:</span> <span class="kc">False</span>
<span class="o">----------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">entries</span> <span class="n">returned</span> <span class="mi">3</span>
<span class="o">----------------------------</span>
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-server-configuration">IPA server configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-replica-configuration">IPA replica configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-replica-server-in-ipaservers-group">IPA replica server in ipaservers group</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ipa-client-enrolled-and-promoted-to-replica-with-one-time-password-in-one-step">IPA client enrolled and promoted to replica with One Time Password in one step</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FreeIPA Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, FreeIPA Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>